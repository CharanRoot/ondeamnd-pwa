(this["webpackJsonpon-demand-app"]=this["webpackJsonpon-demand-app"]||[]).push([[0],{105:function(e,t,n){"use strict";t.a={aws_project_region:"us-east-1",aws_cognito_identity_pool_id:"us-east-1:780660c0-fe39-4799-8b55-aa24ea58f027",aws_cognito_region:"us-east-1",aws_user_pools_id:"us-east-1_FrdnQ508F",aws_user_pools_web_client_id:"36ple9cs7k9q8ub2cmvu5kec13",oauth:{},aws_appsync_graphqlEndpoint:"https://ntirg4wvdfhq5penwxblokjri4.appsync-api.us-east-1.amazonaws.com/graphql",aws_appsync_region:"us-east-1",aws_appsync_authenticationType:"AMAZON_COGNITO_USER_POOLS",aws_cloud_logic_custom:[{name:"stripeapi",endpoint:"https://15xvd10j24.execute-api.us-east-1.amazonaws.com/dev",region:"us-east-1"}],aws_user_files_s3_bucket:"ondemandappd2a9576520ae431a98cad954a5d551bc211754-dev",aws_user_files_s3_bucket_region:"us-east-1"}},114:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return h}));var a=n(10),r=n.n(a),o=n(13),c=n(105),i=n(129),s=n(242),l=n(11),u=c.a.aws_user_files_s3_bucket_region,m=c.a.aws_user_files_s3_bucket;function d(e){return p.apply(this,arguments)}function p(){return(p=Object(o.a)(r.a.mark((function e(t){var n,a,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=14;break}return n=t.name,a=t.type,o="".concat(Object(i.uuid)()).concat(n),c={bucket:m,key:o,region:u},e.prev=4,e.next=7,l.e.put(o,t,{contentType:a});case 7:return console.log("successfully stored user data!"),e.abrupt("return",c);case 11:e.prev=11,e.t0=e.catch(4),console.log("error: ",e.t0);case 14:case"end":return e.stop()}}),e,null,[[4,11]])})))).apply(this,arguments)}function f(e){return b.apply(this,arguments)}function b(){return(b=Object(o.a)(r.a.mark((function e(t){var n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getImages!",t),n=t.map(g),e.next=4,Promise.all(n);case 4:return a=e.sent,console.log("getImages!",a),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return v.apply(this,arguments)}function v(){return(v=Object(o.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.e.get(t.key);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return E.apply(this,arguments)}function E(){return(E=Object(o.a)(r.a.mark((function e(t){var n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map(y),e.next=3,Promise.all(n);case 3:return a=e.sent,console.log("Done!",a),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return O.apply(this,arguments)}function O(){return(O=Object(o.a)(r.a.mark((function e(t){var n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("originalFile instanceof Blob",t instanceof Blob),console.log("originalFile size ".concat(t.size/1024/1024," MB")),n={maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!1},e.prev=3,e.next=6,Object(s.a)(t,n);case 6:return a=e.sent,console.log("compressedFile instanceof Blob",a instanceof Blob),console.log("compressedFile size ".concat(a.size/1024/1024," MB")),e.next=11,d(a);case 11:return e.abrupt("return",e.sent);case 14:e.prev=14,e.t0=e.catch(3),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[3,14]])})))).apply(this,arguments)}},115:function(e,t,n){"use strict";var a=n(10),r=n.n(a),o=n(13),c=n(7),i=n(0),s=n.n(i),l=n(721),u=n(17),m=n(100),d=n(41),p=n(255),f=n(162),b=(n(211),Object(p.a)((function(e){return Object(f.a)({container:{padding:15}})})));t.a=function(e){var t=e.inputimages,n=e.openPop,a=e.closeAlert,i=s.a.useState("paper"),p=Object(c.a)(i,2),f=p[0],g=p[1],v=(s.a.useContext(u.a),s.a.useState([])),h=Object(c.a)(v,2),E=h[0],y=h[1],O=b();s.a.useEffect((function(){(function(){var e=Object(o.a)(r.a.mark((function e(){var n,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.parse(t),e.next=3,Object(d.getImages)(n);case 3:a=e.sent,console.log("images",a),y(a);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),s.a.useEffect((function(){n&&g("paper")}),[n]);var j=function(){a(!1)},k=s.a.useRef(null);return s.a.useEffect((function(){if(n){var e=k.current;null!==e&&e.focus()}}),[n]),s.a.createElement(l.a,{open:n,fullScreen:!0,onClose:j,scroll:f,"aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description"},s.a.createElement(d.DialogTitle,{id:"scroll-dialog-title",onClose:j},"Ticket Details"),s.a.createElement("div",{className:O.container},s.a.createElement(m.b,null,s.a.createElement("ul",{className:"images"},E.map((function(e,t){return s.a.createElement("li",{key:t},s.a.createElement(m.a,{src:e,alt:"mountains"}))}))))))}},143:function(e,t){},17:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(10),r=n.n(a),o=n(13),c=n(7),i=n(0),s=n.n(i),l=n(11),u=n(68),m=s.a.createContext({user:null,provider:"",name:"",email:"",phoneNumber:"",userId:"",accountType:"",isAuthenticated:function(){return!1},signUp:function(){return new Promise((function(e){return e(0)}))},confirmSignUp:function(){return new Promise((function(e){return e(0)}))},resendSignUp:function(){return new Promise((function(e){return e(0)}))},signIn:function(){return new Promise((function(e){return e(0)}))},signOut:function(){return new Promise((function(e){return e(0)}))},resetPassword:function(){return new Promise((function(e){return e(0)}))},confirmResetPassword:function(){return new Promise((function(e){return e(0)}))}});t.b=function(e){var t=e.children,n=Object(i.useState)(null),a=Object(c.a)(n,2),d=a[0],p=a[1],f=Object(i.useState)(""),b=Object(c.a)(f,2),g=b[0],v=b[1],h=Object(i.useState)(""),E=Object(c.a)(h,2),y=E[0],O=E[1],j=Object(i.useState)(""),k=Object(c.a)(j,2),C=k[0],x=k[1],w=Object(i.useState)(""),S=Object(c.a)(w,2),I=S[0],N=S[1],U=Object(i.useState)(""),T=Object(c.a)(U,2),A=T[0],_=T[1],P=Object(i.useState)(""),$=Object(c.a)(P,2),L=$[0],B=$[1],q=Object(u.g)();Object(i.useEffect)((function(){console.log("checking for authenticated user..."),R()}),[]),Object(i.useEffect)((function(){l.d.listen("auth",(function(e){switch(e.payload.event){case"signIn":R(),q.push("/");break;case"signOut":p(null),v(""),localStorage.setItem("provider",""),O(""),x(""),N(""),_(""),q.push("/")}}))}),[]);var R=function(){l.b.currentAuthenticatedUser().then((function(e){console.log("current",e),p(e);var t=e.email||e.attributes.email||"",n=e.name||e.attributes.email||"",a=localStorage.getItem("provider")||"";_(e.username),O(t),x(n),v(a),B(e.attributes["custom:account_type"]),console.log("provider:",L,e.attributes,e.attributes["custom:account_type"])})).catch((function(e){console.log("no current authenticated user")}))},D=Object(i.useCallback)((function(e,t,n,a){return new Promise(function(){var c=Object(o.a)(r.a.mark((function o(c,i){var s,u,m;return r.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,l.b.signUp({username:"+1"+n,password:t,attributes:{email:e,phone_number:"+1"+n,"custom:account_type":a}});case 3:s=r.sent,u=s.user,console.log(u),c(u),r.next=21;break;case 9:r.prev=9,r.t0=r.catch(0),console.log(r.t0),m="An internal error occurred.",r.t1=r.t0.code,r.next="UserNotConfirmedException"===r.t1||"PasswordResetRequiredException"===r.t1||"NotAuthorizedException"===r.t1||"UserNotFoundException"===r.t1||"UsernameExistsException"===r.t1?16:18;break;case 16:return m=r.t0.message,r.abrupt("break",20);case 18:return console.log(r.t0),r.abrupt("break",20);case 20:i(m);case 21:case"end":return r.stop()}}),o,null,[[0,9]])})));return function(e,t){return c.apply(this,arguments)}}())}),[]),W=Object(i.useCallback)((function(e,t){return console.log("confirm sign up",e,t),new Promise(function(){var n=Object(o.a)(r.a.mark((function n(a,o){var c,i,s;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,l.b.confirmSignUp("+1"+e,t);case 3:c=n.sent,i=c.user,a(i),n.next=12;break;case 8:n.prev=8,n.t0=n.catch(0),s=n.t0.message||"An internal error occurred.",o(s);case 12:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e,t){return n.apply(this,arguments)}}())}),[]),M=Object(i.useCallback)((function(e,t){return console.log("sign in",e,t),new Promise(function(){var n=Object(o.a)(r.a.mark((function n(a,o){var c,i;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,l.b.signIn({username:"+1"+e,password:t});case 3:c=n.sent,localStorage.setItem("provider","email"),console.log(c),a(c),n.next=13;break;case 9:n.prev=9,n.t0=n.catch(0),i=n.t0.message||"An internal error occurred.",o(i);case 13:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e,t){return n.apply(this,arguments)}}())}),[]),J=Object(i.useCallback)((function(e){return console.log("resend sign up",e),new Promise((function(t,n){l.b.resendSignUp("+1"+e).then((function(e){t(e)})).catch((function(e){var t=e.message||"An internal error occurred.";n(t)}))}))}),[]),F=Object(i.useCallback)((function(){return console.log("sign out"),new Promise((function(e,t){l.b.signOut().then((function(t){e(t)})).catch((function(e){var n=e.message||"An internal error occurred.";t(n)}))}))}),[]),z=Object(i.useCallback)((function(e){return console.log("reset password",e),new Promise((function(t,n){l.b.forgotPassword("+1"+e).then((function(e){t(e)})).catch((function(e){var t=e.message||"An internal error occurred.";n(t)}))}))}),[]),V=Object(i.useCallback)((function(e,t,n){return console.log("confirm reset password",e,n,t),new Promise((function(a,r){l.b.forgotPasswordSubmit("+1"+e,n,t).then((function(e){return a(e)})).catch((function(e){var t=e.message||"An internal error occurred.";r(t)}))}))}),[]);return s.a.createElement(m.Provider,{value:{user:d,provider:g,name:C,email:y,phoneNumber:I,accountType:L,userId:A,isAuthenticated:function(){return null!==d},signUp:D,confirmSignUp:W,resendSignUp:J,signIn:M,signOut:F,resetPassword:z,confirmResetPassword:V}},t)}},211:function(e,t,n){},212:function(e,t){},213:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(0),r=n.n(a),o=n(257),c=n(722),i=n(255),s=n(162),l=Object(i.a)((function(e){return Object(s.a)({backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}})})),u=function(e){var t=l();return r.a.createElement("div",null,r.a.createElement(o.a,{className:t.backdrop,open:e.open,onClick:function(){}},r.a.createElement(c.a,{color:"inherit"})))}},218:function(e,t,n){},277:function(e,t,n){e.exports=n(716)},41:function(e,t,n){"use strict";var a=n(79);n.d(t,"DialogTitle",(function(){return a.a}));var r=n(114);n.d(t,"getImages",(function(){return r.a})),n.d(t,"handleImageUpload",(function(){return r.b}));n(115);var o=n(212);n.o(o,"TVBackdrop")&&n.d(t,"TVBackdrop",(function(){return o.TVBackdrop}));var c=n(213);n.d(t,"TVBackdrop",(function(){return c.a}))},680:function(e,t,n){},694:function(e,t,n){},716:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(19),c=n.n(o),i=n(33),s=n(17),l=(n(680),n(131)),u=n(68),m=n(7),d=n(790),p=n(773),f=n(769),b=n(253),g=n(770),v={typography:{fontFamily:["Roboto","sans-serif"].join(",")}},h=Object(b.a)(v),E=function(e){var t=e.children;return r.a.createElement(f.a,{theme:h},r.a.createElement(g.a,null,t))},y=n(66),O=n(774),j=n(255),k=n(162),C=n(60);function x(){return r.a.createElement(y.a,{variant:"body2",color:"textSecondary",align:"center"},"TravTail \u2122 ",r.a.createElement(p.a,{color:"inherit",href:"https://travtail.com/"}),(new Date).getFullYear())}var w=Object(j.a)((function(e){return Object(k.a)({footer:{padding:e.spacing(2),marginTop:"auto",backgroundColor:"#f6f6f6"}})})),S=function(){var e=w(Object(C.a)());return r.a.createElement("footer",{className:e.footer},r.a.createElement(O.a,{maxWidth:"sm"},r.a.createElement(x,null)))},I=n(718),N=n(775),U=n(776),T=n(123),A=n.n(T),_=n(235),P=n.n(_),$=n(236),L=n.n($),B=Object(j.a)((function(e){return Object(k.a)({appBar:{boxShadow:"none",backgroundColor:"transparent"},appBarBefore:{backgroundColor:"#fff",border:1},menuButton:{marginRight:e.spacing(2)},spacer:{flexGrow:1}})})),q=function(e){var t=e.header,n=B(Object(C.a)()),o=Object(a.useContext)(s.a),c=Object(u.g)(),i=r.a.useState(!1),l=Object(m.a)(i,2),d=(l[0],l[1]),p=o.isAuthenticated()?r.a.createElement("div",null,r.a.createElement(I.a,{"aria-label":"show 17 new notifications",color:"inherit",className:n.menuButton,onClick:function(){return c.push("/chat")}},r.a.createElement(P.a,{color:"action"})),t?r.a.createElement(I.a,{"aria-label":"show 17 new notifications",color:"inherit",className:n.menuButton,onClick:function(){d(!0)}},r.a.createElement(L.a,{color:"action"})):null):null;return r.a.createElement(N.a,{position:"fixed",className:o.isAuthenticated()?n.appBarBefore:n.appBar},r.a.createElement(U.a,null,r.a.createElement(I.a,{edge:"start",className:n.menuButton,onClick:function(){return c.push("/")},color:"inherit","aria-label":"home"},r.a.createElement(A.a,{color:"action"})),r.a.createElement("div",{className:n.spacer}),p))},R=n(777),D=Object(j.a)((function(e){return Object(k.a)({root:{display:"flex",flexDirection:"column",minHeight:"100vh"},main:{marginBottom:e.spacing(2)}})})),W=function(e){var t=e.title,n=e.children,o=D(Object(C.a)());return Object(a.useEffect)((function(){document.title=t}),[t]),r.a.createElement(E,null,r.a.createElement("div",{className:o.root},r.a.createElement(R.a,null),r.a.createElement(q,null),r.a.createElement(O.a,{className:o.main,maxWidth:"sm"},n),r.a.createElement(S,null)))},M=n(4),J=n(237),F=n.n(J),z=n(239),V=n.n(z),G=n(240),H=n.n(G),Z=n(71),Y=n.n(Z),K=n(132),X=n(778),Q=n(813),ee=n(779),te=n(238),ne=n.n(te),ae={success:F.a,warning:ne.a,error:V.a,info:H.a},re=Object(j.a)((function(e){return{success:{backgroundColor:K.a[600]},error:{backgroundColor:e.palette.error.dark},info:{backgroundColor:e.palette.primary.main},warning:{backgroundColor:X.a[700]},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"}}}));function oe(e){var t=re(),n=e.className,a=e.message,o=e.onClose,c=e.variant,i=ae[c];return r.a.createElement(ee.a,{className:Object(M.a)(t[c],n),"aria-describedby":"client-snackbar",message:r.a.createElement("span",{id:"client-snackbar",className:t.message},r.a.createElement(i,{className:Object(M.a)(t.icon,t.iconVariant)}),a),action:[r.a.createElement(I.a,{key:"close","aria-label":"close",color:"inherit",onClick:o},r.a.createElement(Y.a,{className:t.icon}))]})}var ce=Object(j.a)((function(e){return{margin:{margin:e.spacing(1)}}})),ie=function(e){var t=e.variant,n=e.message,o=e.setMessage,c=ce(),i=Object(a.useState)(!1),s=Object(m.a)(i,2),l=s[0],u=s[1];Object(a.useEffect)((function(){u(""!==n)}),[n]),Object(a.useEffect)((function(){!l&&o("")}),[l]);var d=function(e,t){"clickaway"!==t&&u(!1)},p=r.a.createElement(Q.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:l,autoHideDuration:3e3,onClose:d},r.a.createElement(oe,{onClose:d,className:c.margin,variant:t,message:n}));return r.a.createElement("div",null,p)},se=n(781),le=Object(j.a)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object(C.a)();return Object(k.a)({form:{width:"100%",marginTop:e.spacing(1)},textfield:{margin:e.spacing(2,0,0)},paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},submit:{margin:e.spacing(3,0,2)},links:{padding:"0px 5px"},btn:{width:"100%",maxWidth:"260px",marginTop:e.spacing(2)},btnFederated:{backgroundColor:"white",color:e.palette.grey[600]},btnElems:{display:"grid",width:"100%",gridTemplateColumns:"repeat(12, 2fr)"},btnIcon:{display:"flex",gridColumnEnd:"span 2"},btnLabel:{height:"100%",display:"flex",justifyContent:"center",gridColumnEnd:"span 10",textTransform:"none"},input:{padding:"11.5px 10px"},container:{display:"grid",width:"100%",gridTemplateColumns:"repeat(12, 2fr)"}})})),ue=function(e){var t=e.children,n=e.disabled,a=le();return r.a.createElement(se.a,{type:"submit",disabled:n,fullWidth:!0,variant:"contained",color:"primary",size:"large",className:a.submit},t)},me=n(782),de=n(783),pe=n(784),fe=n(816),be=n(785),ge=n(786),ve=n(787),he=function(e){var t=e.setPassword,n=Object(a.useState)(!1),o=Object(m.a)(n,2),c=o[0],i=o[1],s=Object(a.useState)(!0),l=Object(m.a)(s,2),u=l[0],d=l[1],p=Object(a.useState)(""),f=Object(m.a)(p,2),b=f[0],g=f[1],v=null,h=le(),E=u?null:r.a.createElement(me.a,{error:!u,id:"standard-weight-helper-text"},b);return r.a.createElement(de.a,{required:!0,variant:"outlined",fullWidth:!0,className:h.textfield},r.a.createElement(pe.a,{htmlFor:"outlined-adornment-password",error:!u},"Password"),r.a.createElement(fe.a,{required:!0,error:!u,id:"outlined-adornment-password",type:c?"text":"password",onChange:function(e){return n=e.target.value,null!==v&&clearTimeout(v),void(v=setTimeout((function(){var e=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,32}$/.test(n);d(e),g(n.length>0?"Invalid password.":"Enter password."),t(e?n:""),v=null}),200));var n},endAdornment:r.a.createElement(be.a,{position:"end"},r.a.createElement(I.a,{"aria-label":"toggle password visibility",onClick:function(){i(!c)},onMouseDown:function(e){e.preventDefault()}},c?r.a.createElement(ge.a,null):r.a.createElement(ve.a,null))),labelWidth:80}),E)},Ee=n(817),ye=n(241),Oe=n.n(ye),je=function(e){var t=e.title,n=e.children,a=le();return r.a.createElement(O.a,{maxWidth:"xs"},r.a.createElement(R.a,null),r.a.createElement("div",{className:a.paper},r.a.createElement(Ee.a,{className:a.avatar},r.a.createElement(Oe.a,null)),r.a.createElement(y.a,{component:"h1",variant:"h5"},t),n))},ke=n(806),Ce=function(e){var t=e.setPhoneNumber,n=Object(a.useState)(!0),o=Object(m.a)(n,2),c=o[0],i=o[1],s=Object(a.useState)(""),l=Object(m.a)(s,2),u=l[0],d=l[1],p=null;return r.a.createElement(ke.a,{error:!c,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"phoneNumber",label:"Phone Number",name:"phoneNumber",autoComplete:"phoneNumber",helperText:u,onChange:function(e){return n=e.currentTarget.value,null!==p&&clearTimeout(p),void(p=setTimeout((function(){var e=/^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/im.test(n);console.log("phone",n),i(e),d(e?"":n.length>0?"Invalid phoneNumber.":"Enter phoneNumber."),t(e?n:""),p=null}),200));var n}})},xe=function(){var e=Object(a.useContext)(s.a),t=Object(a.useState)(""),n=Object(m.a)(t,2),o=(n[0],n[1],Object(a.useState)("")),c=Object(m.a)(o,2),i=c[0],l=c[1],f=Object(a.useState)(!0),b=Object(m.a)(f,2),g=b[0],v=b[1],h=Object(a.useState)(""),E=Object(m.a)(h,2),y=E[0],O=E[1],j=Object(u.g)(),k=Object(a.useState)(""),C=Object(m.a)(k,2),x=C[0],w=C[1];Object(a.useEffect)((function(){v(!(x&&i))}),[x,i]);var S=Object(a.useCallback)((function(e){O(e)}),[]),I=le();return r.a.createElement(W,{title:"RA2 Sign In"},r.a.createElement(je,{title:"Sign In"},r.a.createElement(ie,{variant:"error",message:y,setMessage:function(e){return S(e)}}),r.a.createElement("form",{className:I.form,onSubmit:function(t){return function(t){t.preventDefault(),e.signIn(x,i).then((function(e){console.log("sign in success!")})).catch((function(e){console.error("error:",e),O(e)}))}(t)},noValidate:!0},r.a.createElement(Ce,{setPhoneNumber:function(e){return w(e)}}),r.a.createElement(he,{setPassword:function(e){return l(e)}}),r.a.createElement(ue,{disabled:g},"Sign In"),r.a.createElement(d.a,{container:!0},r.a.createElement(d.a,{item:!0,xs:!0,className:I.links},r.a.createElement(p.a,{href:"#",onClick:function(){return j.push("/auth/resetpassword")},variant:"body2"},"Forgot password?")),r.a.createElement(d.a,{item:!0,className:I.links},r.a.createElement(p.a,{href:"#",onClick:function(){return j.push("/auth/signup")},variant:"body2"},"Sign Up"))))))},we=n(808),Se=n(811),Ie=n(791),Ne=n(719),Ue=function(e){var t=e.setEmail,n=Object(a.useState)(!0),o=Object(m.a)(n,2),c=o[0],i=o[1],s=Object(a.useState)(""),l=Object(m.a)(s,2),u=l[0],d=l[1],p=null;return r.a.createElement(ke.a,{error:!c,variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"email",label:"Email Address",name:"email",autoComplete:"email",helperText:u,onChange:function(e){return n=e.currentTarget.value,null!==p&&clearTimeout(p),void(p=setTimeout((function(){var e=/^[a-zA-Z0-9.]+@[a-zA-Z0-9]+\.[A-Za-z]+$/.test(n);i(e),d(e?"":n.length>0?"Invalid email.":"Enter email."),t(e?n:""),p=null}),200));var n}})},Te=function(e){var t=e.setRePassword,n=Object(a.useState)(!1),o=Object(m.a)(n,2),c=o[0],i=o[1],s=Object(a.useState)(!0),l=Object(m.a)(s,2),u=l[0],d=l[1],p=Object(a.useState)(""),f=Object(m.a)(p,2),b=f[0],g=f[1],v=null,h=le(),E=u?null:r.a.createElement(me.a,{error:!u,id:"standard-weight-helper-text"},b);return r.a.createElement(de.a,{required:!0,variant:"outlined",fullWidth:!0,className:h.textfield},r.a.createElement(pe.a,{htmlFor:"outlined-adornment-re-password",error:!u},"Re Enter Password"),r.a.createElement(fe.a,{required:!0,error:!u,id:"outlined-adornment-re-password",type:c?"text":"password",onChange:function(e){return n=e.target.value,null!==v&&clearTimeout(v),void(v=setTimeout((function(){var e=/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,32}$/.test(n);d(e),g(n.length>0?"Invalid password.":"Enter password."),t(e?n:""),v=null}),200));var n},endAdornment:r.a.createElement(be.a,{position:"end"},r.a.createElement(I.a,{"aria-label":"toggle password visibility",onClick:function(){i(!c)},onMouseDown:function(e){e.preventDefault()}},c?r.a.createElement(ge.a,null):r.a.createElement(ve.a,null))),labelWidth:80}),E)},Ae=function(){var e=Object(a.useContext)(s.a),t=Object(a.useState)(""),n=Object(m.a)(t,2),o=n[0],c=n[1],i=Object(a.useState)(""),l=Object(m.a)(i,2),f=l[0],b=l[1],g=Object(a.useState)(""),v=Object(m.a)(g,2),h=(v[0],v[1]),E=Object(a.useState)(""),y=Object(m.a)(E,2),O=y[0],j=y[1],k=Object(a.useState)(!0),C=Object(m.a)(k,2),x=C[0],w=C[1],S=Object(a.useState)(""),I=Object(m.a)(S,2),N=I[0],U=I[1],T=Object(u.g)(),A=r.a.useState(""),_=Object(m.a)(A,2),P=_[0],$=_[1];Object(a.useEffect)((function(){w(!(o&&f&&O&&P))}),[o,f,O,P]);var L=Object(a.useCallback)((function(e){U(e)}),[]),B=le();return r.a.createElement(W,{title:"Sign Up"},r.a.createElement(je,{title:"Sign Up"},r.a.createElement(ie,{variant:"error",message:N,setMessage:function(e){return L(e)}}),r.a.createElement("form",{className:B.form,onSubmit:function(t){return function(t){t.preventDefault();var n=O.replace(/^\D+/g,"");e.signUp(o,f,n,P).then((function(e){T.push("/auth/signup/confirm",n)})).catch((function(e){console.error("error:",e),U(e)}))}(t)},noValidate:!0},r.a.createElement(Ce,{setPhoneNumber:function(e){return j(e)}}),r.a.createElement(Ue,{setEmail:function(e){return c(e)}}),r.a.createElement(he,{setPassword:function(e){return b(e)}}),r.a.createElement(Te,{setRePassword:function(e){return h(e)}}),r.a.createElement(de.a,{className:B.form,component:"fieldset"},r.a.createElement(Ne.a,{component:"legend"},"Account Type"),r.a.createElement(Se.a,{row:!0,"aria-label":"position",value:P,onChange:function(e){$(e.target.value)}},r.a.createElement(Ie.a,{value:"Customer",control:r.a.createElement(we.a,null),label:"Customer"}),r.a.createElement(Ie.a,{value:"Employee",control:r.a.createElement(we.a,null),label:"Employee"}))),r.a.createElement(ue,{disabled:x},"Sign Up"),r.a.createElement(d.a,{container:!0},r.a.createElement(d.a,{item:!0,xs:!0,className:B.links},r.a.createElement(p.a,{href:"#",onClick:function(){return T.push("/auth")},variant:"body2"},"Sign In")),r.a.createElement(d.a,{item:!0,className:B.links},r.a.createElement(p.a,{href:"#",onClick:function(){return T.push("/auth/signup/confirmemail")},variant:"body2"},"Confirm Sign Up"))))))},_e=function(e){var t=e.setCode,n=Object(a.useState)(""),o=Object(m.a)(n,2),c=o[0],i=o[1],s=null;return r.a.createElement(ke.a,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"confirmation",label:"Confirmation Code",name:"confirmation",helperText:c,onChange:function(e){return n=e.currentTarget.value,null!==s&&clearTimeout(s),void(s=setTimeout((function(){var e=6===n.length;i(e?"":"Incorrect code length."),t(e?n:""),s=null}),300));var n}})},Pe=function(e){var t=Object(a.useContext)(s.a),n=Object(a.useState)(""),o=Object(m.a)(n,2),c=o[0],i=o[1],l=Object(a.useState)(!0),f=Object(m.a)(l,2),b=f[0],g=f[1],v=Object(a.useState)(""),h=Object(m.a)(v,2),E=h[0],y=h[1],O=Object(a.useState)(""),j=Object(m.a)(O,2),k=j[0],C=j[1],x=Object(u.g)(),w=e.location.state||"";Object(a.useEffect)((function(){g(!c)}),[c]);var S=Object(a.useCallback)((function(e){y(e)}),[]),I=Object(a.useCallback)((function(e){C(e)}),[]),N=le();return r.a.createElement(W,{title:"RA2 Confirm Sign Up"},r.a.createElement(je,{title:"Confirm Sign Up"},r.a.createElement(ie,{variant:"error",message:E,setMessage:function(e){return S(e)}}),r.a.createElement(ie,{variant:"success",message:k,setMessage:function(e){return I(e)}}),r.a.createElement("form",{className:N.form,onSubmit:function(e){return function(e){e.preventDefault(),t.confirmSignUp(w,c).then((function(e){console.log(e),x.push("/")})).catch((function(e){console.error("error:",e),y(e)}))}(e)},noValidate:!0},r.a.createElement(_e,{setCode:function(e){return i(e)}}),r.a.createElement(ue,{disabled:b},"Confirm"),r.a.createElement(d.a,{container:!0},r.a.createElement(d.a,{item:!0,xs:!0,className:N.links}),r.a.createElement(d.a,{item:!0,className:N.links},r.a.createElement(p.a,{href:"#",onClick:function(){t.resendSignUp(w).then((function(e){C("Code resent to your phoneNumber.")})).catch((function(e){console.error("error:",e),y(e)}))},variant:"body2"},"Resend code"))))))},$e=function(){var e=Object(a.useContext)(s.a),t=Object(a.useState)(""),n=Object(m.a)(t,2),o=n[0],c=n[1],i=Object(a.useState)(!0),l=Object(m.a)(i,2),f=l[0],b=l[1],g=Object(a.useState)(""),v=Object(m.a)(g,2),h=v[0],E=v[1],y=Object(a.useState)(""),O=Object(m.a)(y,2),j=O[0],k=O[1],C=Object(u.g)(),x=Object(a.useState)(""),w=Object(m.a)(x,2),S=w[0],I=w[1];Object(a.useEffect)((function(){b(!(S&&o))}),[S,o]);var N=Object(a.useCallback)((function(e){E(e)}),[]),U=Object(a.useCallback)((function(e){k(e)}),[]),T=le();return r.a.createElement(W,{title:"RA2 Confirm Sign Up"},r.a.createElement(je,{title:"Confirm Sign Up"},r.a.createElement(ie,{variant:"error",message:h,setMessage:function(e){return N(e)}}),r.a.createElement(ie,{variant:"success",message:j,setMessage:function(e){return U(e)}}),r.a.createElement("form",{className:T.form,onSubmit:function(t){return function(t){t.preventDefault(),e.confirmSignUp(S,o).then((function(e){console.log(e),C.push("/")})).catch((function(e){console.error("error:",e),E(e)}))}(t)},noValidate:!0},r.a.createElement(Ce,{setPhoneNumber:function(e){return I(e)}}),r.a.createElement(_e,{setCode:function(e){return c(e)}}),r.a.createElement(ue,{disabled:f},"Confirm"),r.a.createElement(d.a,{container:!0},r.a.createElement(d.a,{item:!0,xs:!0,className:T.links}),r.a.createElement(d.a,{item:!0,className:T.links},r.a.createElement(p.a,{href:"#",onClick:function(){e.resendSignUp(S).then((function(e){k("Code resent to your phoneNumber.")})).catch((function(e){console.error("error:",e),E(e)}))},variant:"body2"},"Resend code"))))))},Le=function(){var e=Object(a.useContext)(s.a),t=Object(a.useState)(""),n=Object(m.a)(t,2),o=n[0],c=n[1],i=Object(a.useState)(!0),l=Object(m.a)(i,2),d=l[0],p=l[1],f=Object(a.useState)(""),b=Object(m.a)(f,2),g=(b[0],b[1],Object(u.g)()),v=Object(a.useState)(""),h=Object(m.a)(v,2),E=h[0],y=h[1];Object(a.useEffect)((function(){p(!E)}),[E]);var O=Object(a.useCallback)((function(e){c(e)}),[]),j=le();return r.a.createElement(W,{title:"RA2 Reset Password"},r.a.createElement(je,{title:"Reset Password"},r.a.createElement(ie,{variant:"error",message:o,setMessage:function(e){return O(e)}}),r.a.createElement("form",{className:j.form,onSubmit:function(t){return function(t){t.preventDefault(),e.resetPassword(E).then((function(e){console.log("response",e,E),g.push("/auth/resetpassword/confirm",E)})).catch((function(e){console.error("error:",e),c(e)}))}(t)},noValidate:!0},r.a.createElement(Ce,{setPhoneNumber:function(e){return y(e)}}),r.a.createElement(ue,{disabled:d},"Reset"))))},Be=function(e){var t=Object(a.useContext)(s.a),n=Object(a.useState)(""),o=Object(m.a)(n,2),c=o[0],i=o[1],l=Object(a.useState)(""),f=Object(m.a)(l,2),b=f[0],g=f[1],v=Object(a.useState)(!0),h=Object(m.a)(v,2),E=h[0],y=h[1],O=Object(a.useState)(""),j=Object(m.a)(O,2),k=j[0],C=j[1],x=Object(a.useState)(""),w=Object(m.a)(x,2),S=w[0],I=w[1],N=Object(u.g)(),U=e.location.state||"";Object(a.useEffect)((function(){y(!(b&&c))}),[b,c]);var T=Object(a.useCallback)((function(e){C(e)}),[]),A=Object(a.useCallback)((function(e){I(e)}),[]),_=le();return r.a.createElement(W,{title:"RA2 Confirm Reset"},r.a.createElement(je,{title:"Reset Password"},r.a.createElement(ie,{variant:"error",message:k,setMessage:function(e){return T(e)}}),r.a.createElement(ie,{variant:"success",message:S,setMessage:function(e){return A(e)}}),r.a.createElement("form",{className:_.form,onSubmit:function(e){return function(e){e.preventDefault(),t.confirmResetPassword(U,c,b).then((function(e){console.log(e),N.push("/")})).catch((function(e){console.error("error:",e),C(e)}))}(e)},noValidate:!0},r.a.createElement(he,{setPassword:function(e){return i(e)}}),r.a.createElement(_e,{setCode:function(e){return g(e)}}),r.a.createElement(ue,{disabled:E},"Confirm"),r.a.createElement(d.a,{container:!0},r.a.createElement(d.a,{item:!0,xs:!0,className:_.links}),r.a.createElement(d.a,{item:!0,className:_.links},r.a.createElement(p.a,{href:"#",onClick:function(){t.resendSignUp(U).then((function(e){I("Code resent to your email.")})).catch((function(e){console.error("error:",e),C(e)}))},variant:"body2"},"Resend code"))))))},qe=function(){var e=Object(a.useContext)(s.a),t=Object(u.g)();Object(a.useEffect)((function(){console.log("authenticated?",e.isAuthenticated()),e.isAuthenticated()&&t.push("/")}),[]),e.isAuthenticated()&&t.push("/");var n=e.isAuthenticated()?null:r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/auth",component:xe}),r.a.createElement(u.b,{exact:!0,path:"/auth/signup",component:Ae}),r.a.createElement(u.b,{exact:!0,path:"/auth/signup/confirm",component:Pe}),r.a.createElement(u.b,{exact:!0,path:"/auth/signup/confirmemail",component:$e}),r.a.createElement(u.b,{exact:!0,path:"/auth/resetpassword",component:Le}),r.a.createElement(u.b,{exact:!0,path:"/auth/resetpassword/confirm",component:Be}));return r.a.createElement(r.a.Fragment,null,n)},Re=n(10),De=n.n(Re),We=n(13),Me=n(36),Je=n(161),Fe=n(814),ze=n(795),Ve=n(809),Ge=n(24),He=n(133),Ze=function(e){var t=Object(He.a)({requestOptions:{},debounce:500}),n=t.ready,o=t.value,c=t.suggestions,i=c.status,s=c.data,l=t.setValue,u=t.clearSuggestions,m=(Object(a.useRef)(),function(t){var n=t.description;return function(){l(n,!1),u(),Object(He.b)({address:n}).then((function(t){console.log(t);var n=t[0].geometry.location,a=n.lat,r=n.lng;return console.log("\ud83d\udccd Coordinates: ",t[0].geometry.location),t[0].latitudes=a.toString(),t[0].longitudes=r.toString(),e.googleAddressReturn(t),Object(He.c)(t[0]).then((function(n){var a=n.lat,r=n.lng;console.log("\ud83d\udccd getLatLng: ",t),t[0].latitudes=a.toString(),t[0].longitudes=r.toString(),e.googleAddressReturn(t)}))})).catch((function(e){console.log("\ud83d\ude31 Error: ",e)}))}});return r.a.createElement("div",null,r.a.createElement(ke.a,{required:!0,label:e.label,fullWidth:!0,disabled:!n,onChange:function(e){l(e.target.value)},value:o,autoComplete:"billing address-level2"}),"OK"===i&&r.a.createElement("ul",null,s.map((function(e){var t=e.id,n=e.structured_formatting,a=n.main_text,o=n.secondary_text;return r.a.createElement("li",{key:t,onClick:m(e)},r.a.createElement("strong",null,a)," ",r.a.createElement("small",null,o))}))))},Ye=function(e){var t=[{long_name:"924",short_name:"924",types:["street_number"]},{long_name:"Players Court",short_name:"Players Ct",types:["route"]},{long_name:"Players Club of Brentwood",short_name:"Players Club of Brentwood",types:["neighborhood","political"]},{long_name:"Nashville",short_name:"Nashville",types:["locality","political"]},{long_name:"Davidson County",short_name:"Davidson County",types:["administrative_area_level_2","political"]},{long_name:"Tennessee",short_name:"TN",types:["administrative_area_level_1","political"]},{long_name:"United States",short_name:"US",types:["country","political"]},{long_name:"37211",short_name:"37211",types:["postal_code"]}],n=(t=e[0].address_components).filter((function(e){return!!e.types.includes("street_number")})),a=t.filter((function(e){return!!e.types.includes("route")})),r=t.filter((function(e){return!!e.types.includes("postal_code")})),o=t.filter((function(e){return!!e.types.includes("country")})),c=t.filter((function(e){return!!e.types.includes("administrative_area_level_1")})),i=t.filter((function(e){return!!e.types.includes("locality")})),s=t.filter((function(e){return!!e.types.includes("administrative_area_level_2")})),l={address1:n[0]?n[0].long_name:a[0].long_name,city:i[0]?i[0].long_name:"",county:s[0].long_name,state:c[0].long_name,country:o[0].long_name,zip:r[0].long_name,latitudes:e[0].latitudes,longitudes:e[0].longitudes,formatted_address:e[0].formatted_address};return console.log("address",l),l},Ke=n(128),Xe=n.n(Ke),Qe=n(41),et=Object(j.a)((function(e){return{buttons:{display:"flex",justifyContent:"flex-end"},button:{marginTop:e.spacing(3),marginLeft:e.spacing(1)}}})),tt=function(e){var t=r.a.useContext(s.a),n=et(),o=function(e){var t=e.target,n=t.name,a=t.value;p(Object(Ge.a)({},u,Object(Me.a)({},n,a)))},c=function(){var n=Object(We.a)(De.a.mark((function n(){var a,r,o,c,i,s;return De.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=t.user.attributes.phone_number,r=t.user.attributes.email,!e.address){n.next=8;break}o=JSON.parse(e.address),c=Object(Ge.a)({},u,{pictures:o.pictures,phoneNumber:a,email:r}),e.nextButton(JSON.stringify(c)),n.next=21;break;case 8:if(S(!0),console.log("value",u,O),!(O.length>0)){n.next=19;break}return n.next=13,Object(Qe.handleImageUpload)(O);case 13:i=n.sent,console.log("S3path",i),s=Object(Ge.a)({},u,{pictures:JSON.stringify(i),phoneNumber:a,email:r}),e.nextButton(JSON.stringify(s)),n.next=20;break;case 19:T("picture missing");case 20:S(!1);case 21:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();r.a.useEffect((function(){var t=function(){var e=Object(We.a)(De.a.mark((function e(t){var n,a,r;return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=JSON.parse(t),a=null,!n.pictures){e.next=8;break}return r=JSON.parse(n.pictures),e.next=6,Object(Qe.getImages)(r);case 6:a=e.sent,console.log("images",a);case 8:p(Object(Ge.a)({},n,{pictures:a})),S(!1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();e.address&&(S(!0),t(e.address))}),[e.address]);var i=Object(a.useState)({firstName:"",lastName:"",middelName:"",address1:"",address2:"",city:"",state:"",zip:"",country:"",county:"",latitudes:"",longitudes:"",aboutme:"",pictures:""}),l=Object(m.a)(i,2),u=l[0],p=l[1],f=Object(a.useState)(!0),b=Object(m.a)(f,2),g=b[0],v=b[1];Object(a.useEffect)((function(){var e=u.firstName,t=u.lastName,n=u.address1,a=u.city,r=u.zip,o=u.country,c=u.aboutme;v(!(e&&t&&n&&a&&r&&o&&c))}),[u]);var h=Object(a.useState)([]),E=Object(m.a)(h,2),O=E[0],j=E[1],k=function(){var e=Object(We.a)(De.a.mark((function e(t){return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=Object(a.useState)(!1),x=Object(m.a)(C,2),w=x[0],S=x[1],I=Object(a.useState)(""),N=Object(m.a)(I,2),U=N[0],T=N[1],A=r.a.useCallback((function(e){T(e)}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{variant:"h6",gutterBottom:!0},"Your Information"),r.a.createElement(d.a,{container:!0,spacing:1},r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(ke.a,{required:!0,id:"firstName",name:"firstName",label:"First name",fullWidth:!0,onChange:o,value:u.firstName,autoComplete:"fname"})),r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(ke.a,{required:!0,id:"middelName",name:"middelName",label:"Middel Name",fullWidth:!0,onChange:o,value:u.middelName,autoComplete:"middelName"})),r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(ke.a,{required:!0,id:"lastName",name:"lastName",label:"Last name",fullWidth:!0,onChange:o,value:u.lastName,autoComplete:"lname"})),u.address1.length<2?r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(Ze,{label:"Enter your Home address",googleAddressReturn:function(e){console.log("address",e);var t=Ye(e);p(Object(Ge.a)({},u,{},t))}})):r.a.createElement(d.a,{container:!0,spacing:1},r.a.createElement(d.a,{item:!0,xs:12},r.a.createElement(ke.a,{required:!0,id:"address1",name:"address1",label:"Address line 1",fullWidth:!0,onChange:o,value:u.address1,autoComplete:"billing address-line1"})),r.a.createElement(d.a,{item:!0,xs:12},r.a.createElement(ke.a,{id:"address2",name:"address2",label:"Address line 2",fullWidth:!0,onChange:o,value:u.address2,autoComplete:"billing address-line2"})),r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(ke.a,{required:!0,id:"city",name:"city",label:"City",fullWidth:!0,onChange:o,value:u.city,autoComplete:"billing address-level2"})),r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(ke.a,{id:"state",name:"state",label:"State/Province/Region",onChange:o,value:u.state,fullWidth:!0})),r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(ke.a,{required:!0,id:"zip",name:"zip",label:"Zip / Postal code",fullWidth:!0,onChange:o,value:u.zip,autoComplete:"billing postal-code"})),r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(ke.a,{required:!0,id:"country",name:"country",label:"Country",fullWidth:!0,onChange:o,value:u.country,autoComplete:"billing country"})),r.a.createElement(d.a,{item:!0,xs:12},r.a.createElement(ke.a,{multiline:!0,rows:"6",required:!0,id:"aboutme",name:"aboutme",label:"About Me",fullWidth:!0,onChange:o,value:u.aboutme,autoComplete:"content"})),r.a.createElement(d.a,{item:!0,xs:12},u.pictures?r.a.createElement("img",{src:u.pictures}):r.a.createElement(Xe.a,{withPreview:!0,withIcon:!0,onChange:k,imgExtension:[".jpg",".gif",".png",".gif"],maxFileSize:5242880}))),r.a.createElement(d.a,{container:!0,direction:"row",justify:"flex-end",alignItems:"center"},r.a.createElement(se.a,{disabled:g,variant:"contained",color:"primary",className:n.button,onClick:c},"next")),r.a.createElement(Qe.TVBackdrop,{open:w}),r.a.createElement(ie,{variant:"error",message:U,setMessage:function(e){return A(e)}})))},nt=n(792),at=Object(j.a)((function(e){return{buttons:{display:"flex",justifyContent:"flex-end"},button:{marginTop:e.spacing(3),marginLeft:e.spacing(1)}}})),rt=[{value:"Paypal",label:"Paypal"},{value:"Venmo",label:"Venmo"}],ot=function(e){var t=at(),n=function(e){var t=e.target,n=t.name,a=t.value;if("secondaryPayment"==n||"dob"==n)s(Object(Ge.a)({},i,Object(Me.a)({},n,a)));else{(""===e.target.value||/^[0-9\b]+$/.test(e.target.value))&&s(Object(Ge.a)({},i,Object(Me.a)({},n,a)))}};Object(a.useEffect)((function(){e.payment&&s(JSON.parse(e.payment))}),[e.payment]);var o=Object(a.useState)({routingNumber:"",bankAccountNumber:"",ssn:"",backgroundcheck:!1,secondaryPayment:"",secondaryPaymentType:"Paypal",dob:"",reroutingNumber:"",rebankAccountNumber:""}),c=Object(m.a)(o,2),i=c[0],s=c[1],l=Object(a.useState)(""),u=Object(m.a)(l,2),p=u[0],f=u[1],b=Object(a.useCallback)((function(e){f(e)}),[]),g=Object(a.useState)(!0),v=Object(m.a)(g,2),h=v[0],E=v[1];return Object(a.useEffect)((function(){var e=i.routingNumber,t=i.bankAccountNumber,n=i.ssn;E(!(e&&t&&n))}),[i]),r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{variant:"h6",gutterBottom:!0},"Payment method"),r.a.createElement(d.a,{container:!0,spacing:1},r.a.createElement(d.a,{item:!0,xs:12,md:6},r.a.createElement(ke.a,{required:!0,id:"routingNumber",name:"routingNumber",label:"Routing Number",onChange:n,value:i.routingNumber,fullWidth:!0})),r.a.createElement(d.a,{item:!0,xs:12,md:6},r.a.createElement(ke.a,{required:!0,id:"reroutingNumber",name:"reroutingNumber",label:"Re Enter Routing Number",onChange:n,value:i.reroutingNumber,fullWidth:!0})),r.a.createElement(d.a,{item:!0,xs:12,md:6},r.a.createElement(ke.a,{required:!0,id:"bankAccountNumber",name:"bankAccountNumber",label:"Bank Account Number",onChange:n,value:i.bankAccountNumber,fullWidth:!0})),r.a.createElement(d.a,{item:!0,xs:12,md:6},r.a.createElement(ke.a,{required:!0,id:"rebankAccountNumber",name:"rebankAccountNumber",label:"Re Enter Bank Account Number",fullWidth:!0,onChange:n,value:i.rebankAccountNumber})),r.a.createElement(nt.a,null),r.a.createElement(d.a,{item:!0,xs:12,md:6},r.a.createElement(y.a,{variant:"h6",gutterBottom:!0},"SSN Number for background Check"),r.a.createElement(ke.a,{required:!0,id:"ssn",name:"ssn",label:"SSN",helperText:"Enter SSN for background Check",fullWidth:!0,onChange:n,value:i.ssn})),r.a.createElement(d.a,{item:!0,xs:12,md:6},r.a.createElement(ke.a,{required:!0,id:"dob",name:"dob",label:"Enter your date of birthday",helperText:"Enter your date of birthday",fullWidth:!0,onChange:n,value:i.dob,type:"date",InputLabelProps:{shrink:!0}})),r.a.createElement(nt.a,null),r.a.createElement(d.a,{item:!0,xs:12,md:6},r.a.createElement(y.a,{variant:"h6",gutterBottom:!0},"Secondary payment method"),r.a.createElement(ke.a,{id:"secondaryPaymentType",name:"secondaryPaymentType",label:"secondaryPaymentType",select:!0,value:i.secondaryPaymentType,onChange:n,SelectProps:{native:!0},helperText:"Please select your currency",variant:"outlined"},rt.map((function(e){return r.a.createElement("option",{key:e.value,value:e.value},e.label)})))),r.a.createElement(d.a,{item:!0,xs:12,md:6},r.a.createElement(ke.a,{required:!0,id:"secondaryPayment",name:"secondaryPayment",label:"Enter your email for secondary Payment",helperText:"Enter your email for secondary Payment",fullWidth:!0,onChange:n,value:i.secondaryPayment})),r.a.createElement(d.a,{container:!0,direction:"row",justify:"flex-end",alignItems:"center"},r.a.createElement("div",{className:t.buttons},r.a.createElement(se.a,{variant:"contained",onClick:e.backButton,className:t.button},"Back"),r.a.createElement(se.a,{disabled:h,variant:"contained",color:"primary",onClick:function(){var t=i.routingNumber,n=i.bankAccountNumber,a=i.ssn,r=i.reroutingNumber,o=i.rebankAccountNumber;return r!==t?(f("Routing number mismattched"),void E(!0)):n!==o?(f("Account number mismattched"),void E(!0)):a.length<2?(f("SSN Number missing"),void E(!0)):(console.log("value",i),void e.nextButton(JSON.stringify(i)))},className:t.button},"Save")))),r.a.createElement(ie,{variant:"error",message:p,setMessage:function(e){return b(e)}}))},ct=n(793),it=n(794),st=n(244),lt=n.n(st),ut=n(243),mt=n.n(ut),dt=Object(j.a)((function(e){return Object(k.a)({appBar:{top:"auto",bottom:0},paper:{paddingBottom:50},root:{display:"flex",flexDirection:"column",minHeight:"90vh"},appBarSpacer:e.mixins.toolbar,stickToBottom:{},main:{flexGrow:1,display:"flex",minHeight:"90vh",paddingLeft:10,paddingRight:10,paddingTop:5},rootB:{}})})),pt=function(e){var t=e.title,n=e.children,o=e.header;Object(a.useEffect)((function(){document.title=t}));var c=Object(u.g)(),i=dt(),s=r.a.useState("home"),l=Object(m.a)(s,2),d=l[0],p=l[1];return r.a.createElement(E,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(R.a,null),r.a.createElement(q,{header:o}),r.a.createElement("main",null,r.a.createElement("div",{className:i.appBarSpacer}),r.a.createElement(Je.a,{square:!0,className:i.paper},r.a.createElement(O.a,{className:i.main},n))),r.a.createElement(N.a,{position:"fixed",color:"primary",className:i.appBar},r.a.createElement(ct.a,{value:d,onChange:function(e,t){console.log("newValue",t),p(t),"account"==t?c.push("/checkout"):"home"==t?c.push("/"):"service"==t&&c.push("/service")},className:i.stickToBottom},r.a.createElement(it.a,{label:"Home",value:"home",icon:r.a.createElement(A.a,null)}),r.a.createElement(it.a,{label:"support",value:"support",icon:r.a.createElement(mt.a,null)}),r.a.createElement(it.a,{label:"Account",value:"account",icon:r.a.createElement(lt.a,null)})))))},ft=n(21),bt=n(22),gt=n.n(bt);function vt(){var e=Object(ft.a)(['\n  mutation updateConvoLink($id: ID!) {\n    updateConvoLink(input: { id: $id, status: "READY" }) {\n      id\n      name\n      convoLinkUserId\n      status\n      conversation {\n        id\n        name\n        createdAt\n        associated {\n          items {\n            convoLinkUserId\n            user {\n              id\n              username\n            }\n          }\n        }\n      }\n    }\n  }\n']);return vt=function(){return e},e}function ht(){var e=Object(ft.a)(["\n  mutation createConvoLink($input: CreateConvoLinkInput!) {\n    createConvoLink(input: $input) {\n      id\n      name\n      status\n      conversation {\n        id\n        name\n        createdAt\n        associated {\n          items {\n            convoLinkUserId\n            user {\n              id\n              username\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return ht=function(){return e},e}function Et(){var e=Object(ft.a)(["\n  mutation RegisterEmployee($input: CreateUserInput!) {\n    registerEmployee(input: $input) {\n      id\n      username\n      registered\n      active\n      address\n      zipcode\n      latitudes\n      longitudes\n      cardInfo\n      userConversations {\n        items {\n          id\n          name\n          status\n          conversation {\n            id\n            name\n            createdAt\n            associated {\n              items {\n                convoLinkUserId\n                user {\n                  id\n                  username\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return Et=function(){return e},e}function yt(){var e=Object(ft.a)(["\n  mutation UpdateEmployee($input: UpdateEmployeeInput!) {\n    updateEmployee(input: $input) {\n      id\n      username\n      registered\n      active\n      address\n      zipcode\n      latitudes\n      longitudes\n      cardInfo\n  }\n}\n"]);return yt=function(){return e},e}function Ot(){var e=Object(ft.a)(["\n  mutation RegisterFullEmployee($input: CreateEmployeeInput!) {\n    registerEmployee(input: $input) {\n      id\n      username\n      registered\n      active\n      address\n      zipcode\n      latitudes\n      longitudes\n      cardInfo\n  }\n}\n"]);return Ot=function(){return e},e}function jt(){var e=Object(ft.a)(["\n  mutation RegisterUser($input: CreateUserInput!) {\n    registerUser(input: $input) {\n      id\n      username\n      registered\n      active\n      address\n      zipcode\n      latitudes\n      longitudes\n      cardInfo\n      userConversations {\n        items {\n          id\n          name\n          status\n          conversation {\n            id\n            name\n            createdAt\n            associated {\n              items {\n                convoLinkUserId\n                user {\n                  id\n                  username\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return jt=function(){return e},e}function kt(){var e=Object(ft.a)(["\n  mutation UpdateUser($input: UpdateUserInput!) {\n    updateUser(input: $input) {\n      id\n      username\n      registered\n      active\n      address\n      zipcode\n      latitudes\n      longitudes\n      cardInfo\n  }\n}\n"]);return kt=function(){return e},e}function Ct(){var e=Object(ft.a)(["\n  mutation registerEmployeeUser($input: CreateEmployeeInput!) {\n    registerEmployee(input: $input) {\n      id\n      username\n      registered\n      active\n      address\n      zipcode\n      latitudes\n      longitudes\n      cardInfo\n  }\n}\n"]);return Ct=function(){return e},e}function xt(){var e=Object(ft.a)(["\n  mutation RegisterFullUser($input: CreateUserInput!) {\n    registerFullUser(input: $input) {\n      id\n      username\n      registered\n      active\n      address\n      zipcode\n      latitudes\n      longitudes\n      cardInfo\n  }\n}\n"]);return xt=function(){return e},e}function wt(){var e=Object(ft.a)(["\n  mutation CreateMessage($input: CreateMessageInput!) {\n    createMessage(input: $input) {\n      id\n      content\n      createdAt\n      owner\n      chatbot\n      isSent\n      file\n      messageConversationId\n      conversation {\n        id\n        name\n        createdAt\n      }\n    }\n  }\n"]);return wt=function(){return e},e}function St(){var e=Object(ft.a)(['\n    mutation UpdateTicket($id: ID!, $ticketEmployeeId: ID!, $ticketEmployeeInfo: String) {\n      updateTicket(\n        input: {\n          id: $id\n          ticketEmployeeId: $ticketEmployeeId\n          ticketEmployeeInfo: $ticketEmployeeInfo\n          status: "assinged"\n        }\n      )\n    {\n      id\n      content\n      time\n      destination\n      price\n      title\n      county\n      source\n      status\n      ticketEmployeeId\n    }\n  }\n']);return St=function(){return e},e}function It(){var e=Object(ft.a)(["\n    mutation UpdateTicket($input: UpdateTicketInput!\n      ) {\n      updateTicket(\n        input: $input\n      )\n    {\n      id\n      content\n      time\n      destination\n      price\n      title\n      county\n      source\n      status\n      ownerUploadImages\n      employeeUploadImages\n      ticketEmployeeId\n      closedComment\n      closedTime\n    }\n  }\n  "]);return It=function(){return e},e}function Nt(){var e=Object(ft.a)(["\n  mutation CreateTicket($input: CreateTicketInput!) {\n    createTicket(input: $input) {\n      id\n      content\n      time\n      destination\n      price\n      title\n      county\n      source\n      status\n      ownerUploadImages\n      employeeUploadImages\n      closedComment\n    }\n  }\n"]);return Nt=function(){return e},e}function Ut(){var e=Object(ft.a)(["\n  mutation CreateConvo($input: CreateConversationInput!) {\n    createConvo(input: $input) {\n      id\n      name\n      createdAt\n      associated {\n        items {\n          convoLinkUserId\n          user {\n            id\n            username\n          }\n        }\n      }\n    }\n  }\n"]);return Ut=function(){return e},e}var Tt=gt()(Ut()),At=gt()(Nt()),_t=gt()(It()),Pt=gt()(St()),$t=gt()(wt()),Lt=(gt()(xt()),gt()(Ct()),gt()(kt())),Bt=gt()(jt()),qt=gt()(Ot()),Rt=gt()(yt()),Dt=(gt()(Et()),gt()(ht())),Wt=gt()(vt()),Mt=n(11);function Jt(){var e=Object(ft.a)(["\n  query GetEmployee($id: ID!) {\n    getEmployee(id: $id) {\n      id\n      username\n      registered\n      employeeConversations {\n        items {\n          id\n          name\n          status\n          conversation {\n            id\n            name\n            createdAt\n            associated {\n              items {\n                convoLinkUserId\n                user {\n                  id\n                  username\n                  avatar\n                }\n                convoLinkEmployeeId\n                employee {\n                  id\n                  username\n                  avatar\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return Jt=function(){return e},e}function Ft(){var e=Object(ft.a)(["\n  query GetUser($id: ID!) {\n    getUser(id: $id) {\n      id\n      username\n      registered\n      userConversations {\n        items {\n          id\n          name\n          status\n          conversation {\n            id\n            name\n            createdAt\n            associated {\n              items {\n                convoLinkUserId\n                user {\n                  id\n                  username\n                }\n                convoLinkEmployeeId\n                employee {\n                  id\n                  username\n                  avatar\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return Ft=function(){return e},e}function zt(){var e=Object(ft.a)(["\nquery getOpenTicket($status: String!, $county: String! ) {\n  jobsByStatus(county: $county,  status: {\n    eq: $status\n  }) \n   {\n      items {\n        id\n        content\n        time\n        destination\n        price\n        title\n        county\n        source\n        status\n        ownerUploadImages\n        employeeUploadImages\n      }\n    nextToken\n   }\n}\n"]);return zt=function(){return e},e}function Vt(){var e=Object(ft.a)(["\n  query SearchConvoLinks(\n    $filter: SearchableConvoLinkFilterInput\n    $sort: SearchableConvoLinkSortInput\n    $limit: Int\n    $nextToken: Int\n  ) {\n    searchConvoLinks(\n      filter: $filter\n      sort: $sort\n      limit: $limit\n      nextToken: $nextToken\n    ) {\n      items {\n        id\n        name\n        status\n        convoLinkUserId\n        user {\n          id\n          username\n          registered\n        }\n        conversation {\n          id\n          name\n          createdAt\n        }\n      }\n      nextToken\n    }\n  }\n"]);return Vt=function(){return e},e}function Gt(){var e=Object(ft.a)(["\n  query SearchUsers(\n    $filter: SearchableUserFilterInput\n    $sort: SearchableUserSortInput\n    $limit: Int\n    $nextToken: Int\n  ) {\n    searchUsers(\n      filter: $filter\n      sort: $sort\n      limit: $limit\n      nextToken: $nextToken\n    ) {\n      items {\n        id\n        username\n        registered\n        userConversations {\n          items {\n            id\n            name\n            status\n            convoLinkUserId\n          }\n          nextToken\n        }\n      }\n      nextToken\n    }\n  }\n"]);return Gt=function(){return e},e}function Ht(){var e=Object(ft.a)(["\n  query SearchMessages(\n    $filter: SearchableMessageFilterInput\n    $sort: SearchableMessageSortInput\n    $limit: Int\n    $nextToken: Int\n  ) {\n    searchMessages(\n      filter: $filter\n      sort: $sort\n      limit: $limit\n      nextToken: $nextToken\n    ) {\n      items {\n        id\n        content\n        createdAt\n        owner\n        chatbot\n        isSent\n        file {\n          bucket\n          region\n          key\n        }\n        messageConversationId\n        conversation {\n          id\n          name\n          createdAt\n        }\n      }\n      nextToken\n    }\n  }\n"]);return Ht=function(){return e},e}function Zt(){var e=Object(ft.a)(["\n  query GetConvo($id: ID!, $nextToken: String) {\n    getConvo(id: $id) {\n      id\n      messages(sortDirection: DESC, limit: 20, nextToken: $nextToken) {\n        nextToken\n        items {\n          id\n          content\n          createdAt\n          owner\n          chatbot\n          isSent\n          file\n          messageConversationId\n        }\n      }\n    }\n  }\n"]);return Zt=function(){return e},e}function Yt(){var e=Object(ft.a)(["\n  query GetFullEmployee($id: ID!) {\n    getEmployee(id: $id) {\n      id\n      username\n      registered\n      active\n      address\n      zipcode\n      latitudes\n      longitudes\n      cardInfo\n    }\n  }\n"]);return Yt=function(){return e},e}function Kt(){var e=Object(ft.a)(["\n  query GetUser($id: ID!) {\n    getUser(id: $id) {\n      id\n      username\n      registered\n      active\n      address\n      zipcode\n      latitudes\n      longitudes\n      cardInfo\n    }\n  }\n"]);return Kt=function(){return e},e}function Xt(){var e=Object(ft.a)(["\n  query GetEmployee($id: ID!) {\n    getEmployee(id: $id) {\n      id\n      username\n      county\n      avatar\n      employeeTickets {\n        items {\n          id\n          content\n          time\n          destination\n          price\n          title\n          county\n          source\n          status\n          ticketEmployeeId\n          ticketUserId\n          closedComment\n          closedTime\n          ownerUploadImages\n          employeeUploadImages\n        }\n      }\n    }\n  }\n"]);return Xt=function(){return e},e}function Qt(){var e=Object(ft.a)(["\n  query GetUser($id: ID!) {\n    getUser(id: $id) {\n      id\n      username\n      county\n      avatar\n      userTickets {\n        items {\n          id\n          content\n          time\n          destination\n          price\n          title\n          county\n          source\n          status\n          ticketEmployeeId\n          ticketUserId\n          closedComment\n          closedTime\n          ownerUploadImages\n          employeeUploadImages\n          employee{\n            username\n            address\n            avatar\n            aboutme\n            address\n          }\n        }\n      }\n    }\n  }\n"]);return Qt=function(){return e},e}var en=gt()(Qt()),tn=gt()(Xt()),nn=gt()(Kt()),an=gt()(Yt()),rn=gt()(Zt()),on=(gt()(Ht()),gt()(Gt()),gt()(Vt()),gt()(zt())),cn=gt()(Ft()),sn=gt()(Jt()),ln=n(257),un=n(722),mn=n(65),dn=n(245),pn=function(){var e=Object(We.a)(De.a.mark((function e(t,n){var a,r;return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={response:!0,body:{email:t,phone:n},headers:{}},e.next=3,Mt.a.post("stripeapi","/stripe/createcustomer",a);case 3:return r=e.sent,console.log("setupIntents",r),e.abrupt("return",{customerId:r.data.url.id,customerKey:r.data.intent.client_secret});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),fn=(n(694),Object(j.a)((function(e){return{buttons:{display:"flex",justifyContent:"flex-end"},button:{marginTop:e.spacing(3),marginLeft:e.spacing(1)}}}))),bn=function(e){var t=Object(mn.useStripe)(),n=Object(mn.useElements)(),a=fn(),o=r.a.useContext(s.a),c=r.a.useState(!1),i=Object(m.a)(c,2),l=i[0],u=i[1];r.a.useEffect((function(){}),[e.payment]);var p=function(){var a=Object(We.a)(De.a.mark((function a(r){var c,i,s,l;return De.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r.preventDefault(),t&&n){a.next=3;break}return a.abrupt("return");case 3:if(!(O.name.length<2)){a.next=6;break}return h("Enter Name"),a.abrupt("return");case 6:return u(!0),c=o.user.attributes.phone_number,i=o.user.attributes.email,a.next=11,pn(i,c);case 11:return s=a.sent,a.next=14,t.confirmCardSetup(s.customerKey,{payment_method:{card:n.getElement(mn.CardNumberElement),billing_details:{name:O.name}}});case 14:(l=a.sent).error?(h(l.error.message),console.log("esult.setupIntent.payment_method",l)):(console.log("esult.setupIntent.payment_method",l.setupIntent),u(!1),e.nextButton(JSON.stringify(Object(Ge.a)({},s,{name:O.name}))));case 16:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),f=r.a.useMemo((function(){return{style:{base:{fontSize:"16px",color:"#424770",letterSpacing:"0.025em",fontFamily:"Source Code Pro, monospace","::placeholder":{color:"#aab7c4"}},invalid:{color:"#9e2146"}}}}),["16px"]),b=r.a.useState(""),g=Object(m.a)(b,2),v=g[0],h=g[1],E=r.a.useState({cardNumber:"",expiry:"",cvc:"",name:""}),y=Object(m.a)(E,2),O=y[0],j=y[1],k=r.a.useCallback((function(e){h(e)}),[]);return r.a.createElement("form",{onSubmit:p},e.payment?r.a.createElement(d.a,{container:!0,direction:"row",justify:"center",alignItems:"center"},r.a.createElement("div",null," you already have payment details in your account. if you want update details contact@travtrail.com ")):r.a.createElement(d.a,{container:!0,spacing:1},r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(ke.a,{required:!0,id:"firstName",name:"firstName",label:"First name",fullWidth:!0,onChange:function(e){var t=e.target.value;j(Object(Ge.a)({},O,{name:t}))},value:O.name,autoComplete:"fname"})),r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement("label",null,"Card number",r.a.createElement(mn.CardNumberElement,{options:f,onReady:function(){console.log("CardNumberElement [ready]")},onChange:function(e){console.log("CardNumberElement [change]",e)},onBlur:function(){console.log("CardNumberElement [blur]")},onFocus:function(){console.log("CardNumberElement [focus]")}}))),r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement("label",null,"Expiration date",r.a.createElement(mn.CardExpiryElement,{options:f,onReady:function(){console.log("CardNumberElement [ready]")},onChange:function(e){console.log("CardNumberElement [change]",e)},onBlur:function(){console.log("CardNumberElement [blur]")},onFocus:function(){console.log("CardNumberElement [focus]")}}))),r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement("label",null,"CVC",r.a.createElement(mn.CardCvcElement,{options:f,onReady:function(){console.log("CardNumberElement [ready]")},onChange:function(e){console.log("CardNumberElement [change]",e)},onBlur:function(){console.log("CardNumberElement [blur]")},onFocus:function(){console.log("CardNumberElement [focus]")}}))),r.a.createElement(d.a,{container:!0,direction:"row",justify:"flex-end",alignItems:"center"},r.a.createElement("div",{className:a.buttons},r.a.createElement(se.a,{variant:"contained",onClick:e.backButton,className:a.button},"Back"),r.a.createElement(se.a,{disabled:!t,variant:"contained",color:"primary",onClick:p,className:a.button},"Save"))),r.a.createElement(ie,{variant:"error",message:v,setMessage:function(e){return k(e)}})),r.a.createElement(Qe.TVBackdrop,{open:l}))},gn=Object(dn.a)("pk_test_n28At7VrrTS32nAdaH5oyTo100BjZFd5oo"),vn=function(e){return r.a.createElement(mn.Elements,{stripe:gn},r.a.createElement(bn,{address:e.address,payment:e.payment,nextButton:e.nextButton,backButton:e.backButton}))},hn=Object(j.a)((function(e){return{appBar:{position:"relative"},layout:Object(Me.a)({width:"auto"},e.breakpoints.up(600+2*e.spacing(2)),{width:600,marginLeft:"auto",marginRight:"auto"}),paper:Object(Me.a)({marginTop:e.spacing(3),marginBottom:e.spacing(3),padding:e.spacing(2)},e.breakpoints.up(600+2*e.spacing(3)),{marginTop:e.spacing(6),marginBottom:e.spacing(6),padding:e.spacing(3)}),stepper:{padding:e.spacing(3,0,5)},buttons:{display:"flex",justifyContent:"flex-end"},button:{marginTop:e.spacing(3),marginLeft:e.spacing(1)},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}})),En=function(){var e=hn(),t=r.a.useState(0),n=Object(m.a)(t,2),o=n[0],c=n[1],i=r.a.useState(""),l=Object(m.a)(i,2),d=l[0],p=l[1],f=r.a.useState(""),b=Object(m.a)(f,2),g=b[0],v=b[1],h=Object(a.useState)(""),E=Object(m.a)(h,2),O=E[0],j=E[1],k=Object(a.useState)(!0),C=Object(m.a)(k,2),x=C[0],w=C[1],S=Object(u.g)(),I=r.a.useContext(s.a),N=Object(a.useState)(!1),U=Object(m.a)(N,2),T=U[0],A=U[1],_=r.a.useState(!1),P=Object(m.a)(_,2),$=P[0],L=P[1],B=["Your Information","Payment details"];Object(a.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(e){Object.keys(e).length>0||j("longitude and latitude missing")}),(function(e){j(e.message)}),{enableHighAccuracy:!0,timeout:2e4,maximumAge:1e3})}),[]),Object(a.useEffect)((function(){if(I&&I.userId){var e=I.user.attributes["custom:account_type"];A("Customer"!==e);var t="Customer"===e?nn:an,n=I.userId;!function(){var a=Object(We.a)(De.a.mark((function a(){var r;return De.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Mt.a.graphql(Object(Mt.g)(t,{id:n}));case 2:r=a.sent,console.log("fetchDate",r),"Customer"===e?r.data.getUser&&(w(!1),p(r.data.getUser.address),v(r.data.getUser.cardInfo)):r.data.getEmployee&&(w(!1),p(r.data.getEmployee.address),v(r.data.getEmployee.cardInfo));case 5:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}()()}}),[I.userId]);var q=function(){var e=Object(We.a)(De.a.mark((function e(t){var n,a,r,o;return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(!0),n=I.userId,a=I.user.attributes["custom:account_type"],r="Customer"===a?x?Bt:Lt:x?qt:Rt,e.next=6,Mt.a.graphql(Object(Mt.g)(r,{input:{id:n,username:JSON.parse(d).firstName,registered:"yes",active:"yes",address:d,zipcode:JSON.parse(d).zip,latitudes:JSON.parse(d).latitudes,longitudes:JSON.parse(d).longitudes,aboutme:JSON.parse(d).aboutme,avatar:JSON.parse(d).pictures,cardInfo:t,county:JSON.parse(d).county}}));case 6:o=e.sent,console.log("response",o),L(!1),S.push("/");case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(We.a)(De.a.mark((function e(t){return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("nextButton",t),0!=o){e.next=5;break}p(t),e.next=9;break;case 5:if(1!=o){e.next=9;break}return v(t),q(t),e.abrupt("return");case 9:W();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var W=function(){c(o+1)},M=function(){c(o-1)},J=Object(a.useCallback)((function(e){j(e)}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(pt,{title:"RA2 Serverless"},r.a.createElement(R.a,null),r.a.createElement("main",{className:e.layout},r.a.createElement(Je.a,{className:e.paper},r.a.createElement(Fe.a,{activeStep:o,className:e.stepper},B.map((function(e){return r.a.createElement(ze.a,{key:e},r.a.createElement(Ve.a,null,e))}))),r.a.createElement(r.a.Fragment,null,o===B.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{variant:"h5",gutterBottom:!0},"Need Update BackEnd.")):r.a.createElement(r.a.Fragment,null,function(e){switch(e){case 0:return r.a.createElement(tt,{address:d,nextButton:D});case 1:return T?r.a.createElement(ot,{payment:g,nextButton:D,backButton:M}):r.a.createElement(vn,{address:d,payment:g,nextButton:D,backButton:M});default:throw new Error("Unknown step")}}(o)))))),r.a.createElement(ie,{variant:"error",message:O,setMessage:function(e){return J(e)}}),r.a.createElement(ln.a,{className:e.backdrop,open:$},r.a.createElement(un.a,{color:"inherit"})))},yn=n(129),On=n(114),jn=Object(j.a)((function(e){return{appBar:{position:"relative"},layout:Object(Me.a)({width:"auto"},e.breakpoints.up(600+2*e.spacing(2)),{width:600,marginLeft:"auto",marginRight:"auto"}),paper:Object(Me.a)({marginTop:e.spacing(3),marginBottom:e.spacing(3),padding:e.spacing(2)},e.breakpoints.up(600+2*e.spacing(3)),{marginTop:e.spacing(6),marginBottom:e.spacing(6),padding:e.spacing(3)}),buttons:{display:"flex",justifyContent:"flex-end"},button:{marginTop:e.spacing(3),marginLeft:e.spacing(1)}}})),kn=function(e){var t=jn(),n=function(e){var t=e.target,n=t.name,a=t.value;if("price"==n){(""===e.target.value||/^([1-9]{0,2}((.)[0-9]{0,2}))$/.test(e.target.value))&&b(Object(Ge.a)({},f,Object(Me.a)({},n,a)))}else b(Object(Ge.a)({},f,Object(Me.a)({},n,a)))},o=Object(u.g)(),c=r.a.useContext(s.a),i=function(){var e=Object(We.a)(De.a.mark((function e(){var t,n,a,r,i,s,l,u,m;return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("createNewTicket",f),a=c.userId,r=c.user.attributes.phone_number,i=c.user.attributes.email,s=JSON.stringify({email:i,phoneNumber:r}),l=[],!(k.length>0)){e.next=10;break}return e.next=9,Object(On.b)(k);case 9:l=e.sent;case 10:return u=Object(yn.uuid)(),"Davidson County",e.next=14,Mt.a.graphql(Object(Mt.g)(At,{input:{id:u,countAndId:"".concat("Davidson County","_").concat(u),price:f.price,time:f.time,title:f.title,content:f.content,destination:null!==(t=f.destination)&&void 0!==t?t:"Davidson County",source:null!==(n=f.source)&&void 0!==n?n:"Davidson County",county:"Davidson County",ownerUploadImages:JSON.stringify(l),ticketUserId:a,status:"open",ticketUserInfo:s}}));case 14:m=e.sent,console.log("response",m),o.push("/");case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=Object(a.useState)({content:"",price:"",title:"",source:"",destination:"",time:"",county:""}),p=Object(m.a)(l,2),f=p[0],b=p[1],g=Object(a.useState)(!0),v=Object(m.a)(g,2),h=v[0],E=v[1];Object(a.useEffect)((function(){var e=f.content,t=f.title,n=f.price,a=f.time;E(!(e&&t&&n&&a))}),[f]);var O=Object(a.useState)([]),j=Object(m.a)(O,2),k=j[0],C=j[1],x=Object(a.useState)({}),w=Object(m.a)(x,2),S=(w[0],w[1],function(){var e=Object(We.a)(De.a.mark((function e(t){return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return r.a.createElement(r.a.Fragment,null,r.a.createElement(pt,{title:"RA2 Serverless"},r.a.createElement(R.a,null),r.a.createElement("main",{className:t.layout},r.a.createElement(Je.a,{className:t.paper},r.a.createElement(y.a,{variant:"h6",gutterBottom:!0},"Job Details"),r.a.createElement(d.a,{container:!0,spacing:1},r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(ke.a,{required:!0,id:"title",name:"title",label:"Title",fullWidth:!0,onChange:n,value:f.title,autoComplete:"title"})),r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(ke.a,{required:!0,id:"price",name:"price",label:"Price",fullWidth:!0,onChange:n,value:f.price,autoComplete:"price"})),r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(Ze,{label:"source",googleAddressReturn:function(e){console.log("address",e);var t=Ye(e);b(Object(Ge.a)({},f,{source:t.formatted_address}))}})),r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(Ze,{label:"destination",googleAddressReturn:function(e){console.log("address",e);var t=Ye(e);b(Object(Ge.a)({},f,{destination:t.formatted_address,county:t.county}))}})),r.a.createElement(d.a,{item:!0,xs:12},r.a.createElement(ke.a,{required:!0,id:"time",name:"time",label:"time",type:"datetime-local",fullWidth:!0,onChange:n,value:f.time,InputLabelProps:{shrink:!0}})),r.a.createElement(d.a,{item:!0,xs:12},r.a.createElement(ke.a,{multiline:!0,rows:"6",required:!0,id:"content",name:"content",label:"content",fullWidth:!0,onChange:n,value:f.content,autoComplete:"content"})),r.a.createElement(d.a,{item:!0,xs:12},r.a.createElement(Xe.a,{withPreview:!0,withIcon:!0,onChange:S,imgExtension:[".jpg",".gif",".png",".gif"],maxFileSize:5242880})),r.a.createElement(d.a,{container:!0,direction:"row",justify:"flex-end",alignItems:"center"},r.a.createElement(se.a,{disabled:h,variant:"contained",color:"primary",className:t.button,onClick:i},"Create Ticket")))))))},Cn=n(789),xn=n(800),wn=n(801),Sn=n(799);function In(){var e=Object(ft.a)(["\n  subscription OnUpdateConvoLink($convoLinkUserId: ID, $status: String) {\n    onUpdateConvoLink(convoLinkUserId: $convoLinkUserId, status: $status) {\n      id\n      name\n      status\n      conversation {\n        id\n        name\n        createdAt\n        associated {\n          items {\n            convoLinkUserId\n            user {\n              id\n              username\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return In=function(){return e},e}function Nn(){var e=Object(ft.a)(["\n  subscription OnUpdatedTicket($county: String!) {\n    onUpdatedTicket(county: $county) {\n      id\n      content\n      time\n      destination\n      price\n      title\n      county\n      source\n      status\n      ticketEmployeeId\n      closedComment\n      closedTime\n    }\n  }\n"]);return Nn=function(){return e},e}function Un(){var e=Object(ft.a)(["\n  subscription OnCreateTicket($county: String!) {\n    onCreateTicket(county: $county) {\n      id\n      content\n      time\n      destination\n      price\n      title\n      county\n      source\n      status\n      ownerUploadImages\n      employeeUploadImages\n      ticketEmployeeId\n      closedComment\n      closedTime\n    }\n  }\n"]);return Un=function(){return e},e}function Tn(){var e=Object(ft.a)(["\n  subscription OnCreateMessage($messageConversationId: ID!) {\n    onCreateMessage(messageConversationId: $messageConversationId) {\n      id\n      content\n      createdAt\n      owner\n      chatbot\n      isSent\n      file\n      messageConversationId\n      conversation {\n        id\n        name\n        createdAt\n      }\n    }\n  }\n"]);return Tn=function(){return e},e}var An=gt()(Tn()),_n=gt()(Un()),Pn=gt()(Nn()),$n=(gt()(In()),n(721)),Ln=n(798),Bn=n(796),qn=n(79),Rn=n(797),Dn=function(e){var t=e.openPop,n=e.type,a=e.closeAlert,o=r.a.useState(!0),c=Object(m.a)(o,2),i=c[0],s=c[1],l=r.a.useState(""),u=Object(m.a)(l,2),d=u[0],p=u[1],f=function(e){var t=e.target,n=(t.name,t.value);p(n),d&&d.length>0&&s(!1)},b=function(){a(!0,d)},g=function(){a(!1,"")};return r.a.createElement("div",null,r.a.createElement($n.a,{open:t,keepMounted:!0,fullWidth:!0,maxWidth:"lg",onClose:g,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description"},"closed"==n?r.a.createElement("div",null,r.a.createElement(qn.a,{id:"alert-dialog-slide-title",onClose:g}," Close Ticket"),r.a.createElement(Bn.a,null,r.a.createElement(Rn.a,{id:"alert-dialog-slide-description"},"Do you want close ticket? ",r.a.createElement("br",null),"Reasons for cancellation."),r.a.createElement(ke.a,{multiline:!0,rows:"4",required:!0,id:"content",autoFocus:!0,name:"content",label:"Close ticket",fullWidth:!0,value:d,onChange:f,autoComplete:"content"})),r.a.createElement(Ln.a,null,r.a.createElement(se.a,{variant:"contained",disabled:i,onClick:b,color:"secondary"},"Close Ticket"))," "):r.a.createElement("div",null,r.a.createElement(qn.a,{id:"alert-dialog-slide-title",onClose:g},n),r.a.createElement(Bn.a,null,r.a.createElement(Rn.a,{id:"alert-dialog-slide-description"},"completed"==n?"Completed":"Unassign"," comments ."),r.a.createElement(ke.a,{multiline:!0,rows:"6",required:!0,autoFocus:!0,id:"content",name:"content",label:"completed"==n?"Completed":"Unassign",fullWidth:!0,value:d,onChange:f,autoComplete:"content"})),r.a.createElement(Ln.a,null,r.a.createElement(se.a,{variant:"contained",disabled:i,onClick:b,color:"primary"},"completed"==n?"Completed":"Unassign"))," ")))},Wn=n(115),Mn=n(810),Jn=n(159),Fn=n.n(Jn),zn=n(246),Vn=n.n(zn),Gn=n(130),Hn=n.n(Gn),Zn=n(100),Yn=(n(211),Object(j.a)((function(e){return Object(k.a)({container:{padding:15}})}))),Kn=function(e){var t=e.employee,n=e.openPop,a=e.closeAlert,o=r.a.useState("paper"),c=Object(m.a)(o,2),i=c[0],l=c[1],u=r.a.useContext(s.a),p=r.a.useState([]),f=Object(m.a)(p,2),b=f[0],g=f[1],v=Yn(),h=r.a.useState(),E=Object(m.a)(h,2),y=E[0],O=E[1];r.a.useEffect((function(){}),[u.userId]),r.a.useEffect((function(){var e=function(){var e=Object(We.a)(De.a.mark((function e(n){var a,r,o;return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=JSON.parse(t.address),O(Object(Ge.a)({},t,{phoneNumber:n,username:"".concat(a.firstName," ").concat(a.lastName)})),!t.avatar){e.next=9;break}return r=JSON.parse(t.avatar),e.next=6,Object(Qe.getImages)(r);case 6:o=e.sent,console.log("images",o),g(o);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();u.userId&&e(u.user.attributes.phone_number)}),[u.userId]),r.a.useEffect((function(){n&&l("paper")}),[n]);var j=function(){a(!1)},k=r.a.useRef(null);return r.a.useEffect((function(){if(n){var e=k.current;null!==e&&e.focus()}}),[n]),r.a.createElement($n.a,{open:n,onClose:j,scroll:i,"aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description"},r.a.createElement(Qe.DialogTitle,{id:"scroll-dialog-title",onClose:j},"Exprert Details"),r.a.createElement("div",{className:v.container},r.a.createElement(d.a,{container:!0,spacing:1},r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(ke.a,{disabled:!0,required:!0,id:"username",name:"username",label:"UserName",fullWidth:!0,defaultValue:null===y||void 0===y?void 0:y.username,autoComplete:"username"})),r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(ke.a,{disabled:!0,required:!0,id:"aboutme",name:"aboutme",label:"About Me",fullWidth:!0,defaultValue:null===y||void 0===y?void 0:y.aboutme,autoComplete:"aboutme"})),r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(ke.a,{disabled:!0,required:!0,id:"phoneNumber",name:"phoneNumber",label:"Phone Number",fullWidth:!0,defaultValue:null===y||void 0===y?void 0:y.phoneNumber,autoComplete:"phoneNumber"}))),r.a.createElement(Zn.b,null,r.a.createElement("ul",{className:"images"},b.map((function(e,t){return r.a.createElement("li",{key:t},r.a.createElement(Zn.a,{src:e,alt:"mountains"}))}))))))},Xn=n(247),Qn=n.n(Xn),ea=function(){var e=Object(We.a)(De.a.mark((function e(t,n){var a,r,o,c,i,s,l,u,m,d,p;return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t,r={name:"direct"},e.next=5,Mt.a.graphql(Object(Mt.g)(Tt,{input:r}));case 5:return o=e.sent,console.log("conversation",o),c={convoLinkUserId:a,convoLinkConversationId:o.data.createConvo.id,status:"CREATING",name:"chat"},i={convoLinkEmployeeId:n,convoLinkConversationId:o.data.createConvo.id,status:"CREATING",name:"chat"},e.next=11,Mt.a.graphql(Object(Mt.g)(Dt,{input:c}));case 11:return s=e.sent,e.next=14,Mt.a.graphql(Object(Mt.g)(Dt,{input:i}));case 14:return l=e.sent,u=s.data.createConvoLink.id,m=l.data.createConvoLink.id,e.next=19,Mt.a.graphql(Object(Mt.g)(Wt,{id:u}));case 19:return d=e.sent,console.log(" mm next steps",d),e.next=23,Mt.a.graphql(Object(Mt.g)(Wt,{id:m}));case 23:p=e.sent,console.log(" xy next steps",p),console.log("item created!",o),e.next=31;break;case 28:e.prev=28,e.t0=e.catch(0),console.log("error creating talk...",e.t0);case 31:case"end":return e.stop()}}),e,null,[[0,28]])})));return function(t,n){return e.apply(this,arguments)}}(),ta=function(){var e=Object(We.a)(De.a.mark((function e(t,n,a){var r,o,c,i,s,l,u;return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("findConverationWithUser",t,n,a),r=a?sn:cn,o=a?n:t,e.next=5,Mt.a.graphql(Object(Mt.g)(r,{id:o}));case 5:if(c=e.sent,console.log("fetchDate",c),!a){e.next=14;break}if(!(c.data.getEmployee&&c.data.getEmployee.employeeConversations.items.length>0)){e.next=12;break}return i=c.data.getEmployee.employeeConversations.items,s=i.find((function(e){var n=e.conversation,a=(n=void 0===n?{}:n).associated,r=(a=void 0===a?{}:a).items;return(void 0===r?[]:r).some((function(e){return e.convoLinkUserId===t}))})),e.abrupt("return",s?{conversation:s.conversation,conversationName:s.name}:null);case 12:e.next=18;break;case 14:if(!(c.data.getUser&&c.data.getUser.userConversations.items.length>0)){e.next=18;break}return l=c.data.getUser.userConversations.items,u=l.find((function(e){var t=e.conversation,a=(t=void 0===t?{}:t).associated,r=(a=void 0===a?{}:a).items;return(void 0===r?[]:r).some((function(e){return e.convoLinkEmployeeId===n}))})),e.abrupt("return",u?{conversation:u.conversation,conversationName:u.name}:null);case 18:return e.abrupt("return",null);case 19:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),na=function(){var e=Object(We.a)(De.a.mark((function e(t,n,a){var r;return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ta(t,n,a);case 2:if(r=e.sent,console.log("existing conv",r),r){e.next=8;break}return console.log("no convo, launch new"),e.next=8,ea(t,n);case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),aa=function(e){var t=e.data,n=e.openPop,a=e.close,o=e.setIsEmployee,c=r.a.useState("paper"),i=Object(m.a)(c,2),l=i[0],p=i[1],f=r.a.useContext(s.a),b=r.a.useState(!0),g=Object(m.a)(b,2),v=g[0],h=g[1],E=Object(u.g)();r.a.useEffect((function(){n&&p("paper")}),[n]);var y=function(e){var t=e.target,n=t.name,a=t.value;I(Object(Ge.a)({},S,Object(Me.a)({},n,a)))};r.a.useEffect((function(){t.id&&I(t),C(t.closedComment)}),[t]);var O=r.a.useState(""),j=Object(m.a)(O,2),k=j[0],C=j[1],x=r.a.useState({content:"",price:"",title:"",source:"",destination:"",time:"",county:""}),w=Object(m.a)(x,2),S=w[0],I=w[1],N=function(){var e=Object(We.a)(De.a.mark((function e(){var n,r,c,i,s,l,u;return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=12;break}return n=f.userId,r=f.user.attributes.phone_number,c=f.user.attributes.email,i=JSON.stringify({email:c,phoneNumber:r}),e.next=7,Mt.a.graphql(Object(Mt.g)(Pt,{id:t.id,ticketEmployeeId:n,ticketEmployeeInfo:i}));case 7:s=e.sent,console.log("accept ticket by employee",s),a(!0,Object(Ge.a)({},t,{status:"assinged",ticketEmployeeId:n})),e.next=22;break;case 12:if(!v){e.next=16;break}h(!1),e.next=22;break;case 16:if(0!=v){e.next=22;break}return e.next=19,Mt.a.graphql(Object(Mt.g)(_t,{input:{id:t.id,price:S.price,time:S.time,title:S.title,content:S.content,county:S.county,destination:null!==(l=S.destination)&&void 0!==l?l:"sfsfsf",source:null!==(u=S.source)&&void 0!==u?u:"sfsfsf"}}));case 19:e.sent,console.log("update ticke4t info",Object(Ge.a)({},t,{},S)),a(!0,Object(Ge.a)({},t,{},S));case 22:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(){a(!1,t)},T=r.a.useRef(null);r.a.useEffect((function(){if(n){var e=T.current;null!==e&&e.focus()}}),[n]);var A=r.a.useState(!1),_=Object(m.a)(A,2),P=_[0],$=_[1],L=r.a.useState(""),B=Object(m.a)(L,2),q=B[0],R=B[1],D=function(){var e=Object(We.a)(De.a.mark((function e(n,r){var o,c;return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!=n){e.next=16;break}if("unassign"!=q){e.next=9;break}return e.next=4,Mt.a.graphql(Object(Mt.g)(_t,{input:{id:t.id,status:"open",ticketEmployeeId:null,ticketEmployeeInfo:null}}));case 4:o=e.sent,console.log("unassign close",o),a(!0,Object(Ge.a)({},t,{},S,{status:"open"})),e.next=14;break;case 9:return e.next=11,Mt.a.graphql(Object(Mt.g)(_t,{input:{id:t.id,status:q,closedComment:r,closedTime:(new Date).toUTCString()}}));case 11:c=e.sent,console.log("update ticke4t to close",c),a(!0,Object(Ge.a)({},t,{},S,{status:q}));case 14:e.next=17;break;case 16:$(!1);case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),W=r.a.useState(!1),M=Object(m.a)(W,2),J=M[0],F=M[1],z=function(){var e=Object(We.a)(De.a.mark((function e(){return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:F(!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),V=r.a.useState(!1),G=Object(m.a)(V,2),H=G[0],Z=G[1],Y=function(){var e=Object(We.a)(De.a.mark((function e(){return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Z(!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=function(){var e=Object(We.a)(De.a.mark((function e(){var n,a,r;return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.userId,a=t.ticketEmployeeId,e.next=4,na(t.ticketUserId,a,o);case 4:r=e.sent,E.push({pathname:"/chat",state:{conversation:r,user:n}});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",null,r.a.createElement($n.a,{open:n,fullScreen:!0,onClose:U,scroll:l,"aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description"},r.a.createElement(qn.a,{id:"scroll-dialog-title",onClose:U},"Ticket Details"),r.a.createElement(Bn.a,{dividers:"paper"===l},r.a.createElement(d.a,{container:!0,spacing:1},r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(ke.a,{disabled:v,required:!0,id:"title",name:"title",label:"Title",fullWidth:!0,onChange:y,value:S.title,autoComplete:"title"})),r.a.createElement(d.a,{item:!0,xs:12,sm:6},r.a.createElement(ke.a,{disabled:v,required:!0,id:"price",name:"price",label:"Price",fullWidth:!0,onChange:y,value:S.price,autoComplete:"price"})),r.a.createElement(d.a,{item:!0,xs:12,sm:6},0==v?r.a.createElement(Ze,{label:"source",googleAddressReturn:function(e){console.log("address",e);var t=Ye(e);I(Object(Ge.a)({},S,{source:t.formatted_address}))}}):r.a.createElement(ke.a,{label:"source",name:"source",fullWidth:!0,disabled:!0,defaultValue:t.source})),r.a.createElement(d.a,{item:!0,xs:12,sm:6},0==v?r.a.createElement(Ze,{label:"destination",googleAddressReturn:function(e){console.log("address",e);var t=Ye(e);I(Object(Ge.a)({},S,{destination:t.formatted_address,county:t.county}))}}):r.a.createElement(ke.a,{label:"destination",name:"destination",fullWidth:!0,disabled:!0,defaultValue:t.destination})),r.a.createElement(d.a,{item:!0,xs:12},0==v?r.a.createElement(ke.a,{required:!0,id:"time",name:"time",label:"time",type:"datetime-local",fullWidth:!0,onChange:y,value:S.time,InputLabelProps:{shrink:!0}}):r.a.createElement(ke.a,{label:"time",name:"time",fullWidth:!0,disabled:!0,defaultValue:S.time})),r.a.createElement(d.a,{item:!0,xs:12},r.a.createElement(ke.a,{disabled:v,multiline:!0,rows:"6",required:!0,id:"content",name:"content",label:"content",fullWidth:!0,onChange:y,value:S.content,autoComplete:"content"})),r.a.createElement(d.a,{item:!0,xs:12,container:!0,direction:"row"},t.ticketEmployeeId?r.a.createElement("div",null,r.a.createElement(Mn.a,{icon:r.a.createElement(Fn.a,null),label:"Expert Info",clickable:!0,color:"primary",onClick:Y,deleteIcon:r.a.createElement(Vn.a,null)}),r.a.createElement(Mn.a,{icon:r.a.createElement(Fn.a,null),label:"Start Chat",clickable:!0,color:"primary",onClick:K,deleteIcon:r.a.createElement(Qn.a,null)})):null,t.ownerUploadImages&&JSON.parse(t.ownerUploadImages).length>0?r.a.createElement(Mn.a,{label:"See Attachments",clickable:!0,color:"primary",onClick:z,deleteIcon:r.a.createElement(Hn.a,null)}):null),"closed"==t.status||"completed"==t.status?r.a.createElement(d.a,{item:!0,xs:12},r.a.createElement(ke.a,{disabled:v,multiline:!0,rows:"3",required:!0,id:"closedComment",name:"closedComment",label:"closedComment",fullWidth:!0,value:k,autoComplete:"content"})):null,r.a.createElement(d.a,{container:!0,direction:"row",justify:"flex-end",alignItems:"center"}))),"closed"==t.status||"completed"==t.status?null:r.a.createElement(Ln.a,null,0==o?r.a.createElement(se.a,{variant:"contained",onClick:function(){R("closed"),$(!0)}},"Close Ticket"):null,o&&"assinged"==t.status?r.a.createElement(se.a,{variant:"contained",onClick:function(){R("unassign"),$(!0)},color:"secondary"},"Unassign"):null,o&&"assinged"==t.status?r.a.createElement(se.a,{variant:"contained",onClick:function(){R("completed"),$(!0)},color:"primary"},"Complete Job"):null,"open"==t.status?r.a.createElement(se.a,{onClick:N,variant:"contained",color:"primary"},o?"Accept":0==v?"Update":"Edit"):null)),P?r.a.createElement(Dn,{type:q,openPop:P,closeAlert:D}):null,J?r.a.createElement(Wn.a,{inputimages:t.ownerUploadImages,openPop:J,closeAlert:function(e){F(!1)}}):null,H?r.a.createElement(Kn,{employee:t.employee,openPop:H,closeAlert:function(e){Z(!1)}}):null)},ra=n(802),oa=n(812),ca=n(248),ia=n.n(ca),sa=Object(j.a)((function(e){return Object(k.a)({root:{width:"100%",maxWidth:400,backgroundColor:e.palette.background.paper},subHeader:{color:"rgba(0, 0, 0, 0.98)",fontSize:18,fontWeight:500},inline:{display:"inline"},button:{width:20,marginTop:15,padding:5,margin:e.spacing(1)},rating:{marginLeft:15},buttonCart:{marginLeft:5,marginTop:15,width:10},buttonGird:{width:90},cartLabel:{fontWeight:900,backgroundColor:"rgba(0, 0, 0, 0.18)",width:50,marginBottom:8,marginTop:8,marginLeft:5,borderRadius:5,paddingLeft:5,color:"black !important"},absolute:{position:"absolute",bottom:e.spacing(9),right:e.spacing(4)},fab:{margin:e.spacing(2)},chipTop:{marginTop:10}})}));function la(){var e=sa(),t=r.a.useState({}),n=Object(m.a)(t,2),o=n[0],c=(n[1],r.a.useContext(s.a)),i=r.a.useState([]),l=Object(m.a)(i,2),p=l[0],f=l[1],b=r.a.useState([]),g=Object(m.a)(b,2),v=g[0],h=g[1],E=r.a.useState([]),O=Object(m.a)(E,2),j=O[0],k=O[1],C=r.a.useState(!1),x=Object(m.a)(C,2),w=(x[0],x[1]),S=Object(u.g)();Object(a.useEffect)((function(){c&&c.userId&&w(!0)}),[c.userId]);var I=function(e){console.log("button click",e),L(e),A(!0)},N=r.a.useState(!1),U=Object(m.a)(N,2),T=U[0],A=U[1],_=r.a.useState({}),P=Object(m.a)(_,2),$=P[0],L=P[1],B=r.a.useState(!1),q=Object(m.a)(B,2),R=q[0],D=q[1],W=r.a.useReducer((function(e,t){switch(t.type){case"ADDNEWJOB":var n=t.errand;p.push(n);var a=JSON.parse(JSON.stringify(p));return f(a),e;case"EXPERTUPDATE":var r=t.errand;if("open"==r.status){console.log("updated",p),p.forEach((function(e,t){e.id===r.id&&(p[t]=r)})),console.log("updated",p);var o=JSON.parse(JSON.stringify(p));f(o)}else{var c=p.filter((function(e){return e.id!=r.id}));f(c)}return e;case"USERUPDATE":var i=t.errand;if("closed"!=i.status&&"completed"!=i.status)for(var s=0;s<v.length;s++)if(v[s].id===i.id&&v[s].status){v[s]=i;var l=JSON.parse(JSON.stringify(v));return h(l),e}return e;default:return e}}),{errand:""}),M=Object(m.a)(W,2),J=(M[0],M[1]);return Object(a.useEffect)((function(){var e,t=c.userId;if(t){var n=c.user.attributes["custom:account_type"];!function(){var a=Object(We.a)(De.a.mark((function a(){var r,o,c,i,s,l,u,m,d,p;return De.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if("Customer"==n){a.next=17;break}return D(!0),a.next=4,Mt.a.graphql(Object(Mt.g)(tn,{id:t}));case 4:return r=a.sent,console.log("acceptedJobs",r),r.data.getEmployee&&r.data.getEmployee.employeeTickets.items.length>0&&(o=r.data.getEmployee.employeeTickets.items,console.log("acceptedJobs",o),c=o.filter((function(e){return"closed"!=e.status&&"completed"!=e.status})),i=o.filter((function(e){return"closed"==e.status||"completed"==e.status})),h(c),k(i)),a.next=9,Mt.a.graphql(Object(Mt.g)(on,{status:"open",county:"Davidson County"}));case 9:s=a.sent,console.log("getOpenTicket",s),s.data.jobsByStatus&&s.data.jobsByStatus.items.length>0&&(l=s.data.jobsByStatus.items,console.log("getOpenTicket",l),f(l)),u=Mt.a.graphql(Object(Mt.g)(_n,{county:"Davidson County"})).subscribe({next:function(e){var t=e.value.data.onCreateTicket;console.log("onCreateTicket",t),J({type:"ADDNEWJOB",errand:t})}}),m=Mt.a.graphql(Object(Mt.g)(Pn,{county:"Davidson County"})).subscribe({next:function(e){var t=e.value.data.onUpdatedTicket;console.log("onUpdatedTicket",t),J({type:"EXPERTUPDATE",errand:t})}}),e=function(){u.unsubscribe(),m.unsubscribe()},a.next=23;break;case 17:return a.next=19,Mt.a.graphql(Object(Mt.g)(en,{id:t}));case 19:d=a.sent,console.log("fetchDate",d),d.data.getUser&&d.data.getUser.userTickets.items.length>0&&(p=d.data.getUser.userTickets.items,console.log("openErrands",p),c=p.filter((function(e){return"closed"!=e.status&&"completed"!=e.status})),i=p.filter((function(e){return"closed"==e.status||"completed"==e.status})),h(c),k(i)),Mt.a.graphql(Object(Mt.g)(Pn,{county:"Davidson County"})).subscribe({next:function(e){var t=e.value.data.onUpdatedTicket;J({type:"USERUPDATE",errand:t})}});case 23:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}()()}return e}),[c.userId]),r.a.createElement(pt,{title:"RA2 Serverless",header:Object.keys(o).length>0?"cart":void 0},r.a.createElement(d.a,{container:!0,direction:"column"},R?r.a.createElement(Cn.a,{component:"nav","aria-labelledby":"nested-list-subheader",subheader:r.a.createElement(Sn.a,{className:e.subHeader,component:"div",id:"nested-list-subheader"},"Open Jobs"),className:e.root},p.length>0?p.map((function(t){return r.a.createElement("div",{key:t.id},r.a.createElement(xn.a,{key:t.id,alignItems:"flex-start",onClick:function(){return I(t)}},r.a.createElement(wn.a,{primary:t.title,secondary:r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{component:"span",variant:"body2",className:e.inline,color:"textPrimary"},"Time : ",t.time," ",r.a.createElement("br",null),"   Address : ",t.destination))}),r.a.createElement(d.a,{className:e.buttonGird,container:!0,direction:"row",justify:"flex-end",alignItems:"flex-end"},r.a.createElement(Mn.a,{avatar:r.a.createElement(Ee.a,null,"$"),size:"small",color:"secondary",label:"".concat(t.price)}),r.a.createElement(Mn.a,{size:"small",color:"primary",label:t.status,className:e.chipTop}))),r.a.createElement(nt.a,{variant:"inset",component:"li"}))})):r.a.createElement("div",null,"No Jobs")):null,r.a.createElement(nt.a,null),r.a.createElement(Cn.a,{component:"nav","aria-labelledby":"nested-list-subheader",subheader:r.a.createElement(Sn.a,{className:e.subHeader,component:"div",id:"nested-list-subheader"},R?"Accepted Jobs ":"Created Jobs"),className:e.root},v.length>0?v.map((function(t){return r.a.createElement("div",{key:t.id},r.a.createElement(xn.a,{key:t.id,alignItems:"flex-start",onClick:function(){return I(t)}},r.a.createElement(wn.a,{primary:t.title,secondary:r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{component:"span",variant:"body2",className:e.inline,color:"textPrimary"},"Time : ",t.time," ",r.a.createElement("br",null),"   Address : ",t.destination))}),r.a.createElement(d.a,{className:e.buttonGird,container:!0,direction:"row",justify:"flex-end",alignItems:"flex-end"},r.a.createElement(Mn.a,{avatar:r.a.createElement(Ee.a,null,"$"),size:"small",color:"secondary",label:"".concat(t.price)}),r.a.createElement(Mn.a,{size:"small",color:"primary",label:t.status,className:e.chipTop}))),r.a.createElement(nt.a,{variant:"inset",component:"li"}))})):r.a.createElement("div",null,"No Jobs")),r.a.createElement(nt.a,null),r.a.createElement(Cn.a,{component:"nav","aria-labelledby":"nested-list-subheader",subheader:r.a.createElement(Sn.a,{className:e.subHeader,component:"div",id:"nested-list-subheader"},R?"Completed Jobs ":"Closed Jobs"),className:e.root},j.length>0?j.map((function(t){return r.a.createElement("div",{key:t.id},r.a.createElement(xn.a,{key:t.id,alignItems:"flex-start",onClick:function(){return I(t)}},r.a.createElement(wn.a,{primary:t.title,secondary:r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{component:"span",variant:"body2",className:e.inline,color:"textPrimary"},"Time : ",t.time," ",r.a.createElement("br",null),"   Address : ",t.destination))}),r.a.createElement(d.a,{className:e.buttonGird,container:!0,direction:"row",justify:"flex-end",alignItems:"flex-end"},r.a.createElement(Mn.a,{avatar:r.a.createElement(Ee.a,null,"$"),size:"small",color:"secondary",label:"".concat(t.price)}),r.a.createElement(Mn.a,{size:"small",color:"primary",label:t.status,className:e.chipTop,deleteIcon:(t.status,r.a.createElement(Y.a,null))}))),r.a.createElement(nt.a,{variant:"inset",component:"li"}))})):r.a.createElement("div",null,"No Jobs")),T?r.a.createElement(aa,{setIsEmployee:R,data:$,openPop:T,close:function(e,t){if(A(!1),e)if(R){if("assinged"==t.status){var n=p.filter((function(e){return e.id!=$.id}));v.push(t),h(v),f(n)}else if("open"==t.status){n=v.filter((function(e){return e.id!=$.id}));h(n),p.push(t),f(p)}else if("completed"==t.status){n=v.filter((function(e){return e.id!=$.id}));h(n),j.push(t),k(j)}}else if("closed"==t.status){n=v.filter((function(e){return e.id!=$.id}));j.push($),k(j),h(n)}else console.log("updateTicket",t),v.forEach((function(e,n){e.id===t.id&&(v[n]=t)})),h(v)}}):null),0==R?r.a.createElement(oa.a,{title:"Add","aria-label":"add"},r.a.createElement(ra.a,{color:"primary",className:e.absolute},r.a.createElement(ia.a,{onClick:function(){console.log("createJob"),S.push("/createticket")}}))):null)}var ua=n(805),ma=(n(218),n(83)),da=n(85),pa=n(86),fa=n(87),ba=n(88),ga=(n(249),n(250)),va=n.n(ga),ha=n(807),Ea=n(803),ya=n(804),Oa=n(30);n(720);var ja=function(e){Object(ba.a)(n,e);var t=Object(fa.a)(n);function n(e,a){var r;return Object(da.a)(this,n),r=t.call(this,e,a),console.log("title",r.props),r}return Object(pa.a)(n,[{key:"render",value:function(){}}]),n}(r.a.Component),ka=null,Ca=function(e){Object(ba.a)(n,e);var t=Object(fa.a)(n);function n(e){var a;return Object(da.a)(this,n),(a=t.call(this,e)).messageInput=void 0,a.ownerInput=void 0,a.ownerAvatarInput=void 0,a.handleFileChange=function(e){var t=e.target.files[0];if(console.log(t),t&&t.type.startsWith("image/")){var n=new FileReader,r=Object(ma.a)(a);n.onload=function(e){r.setState({popoverOpen:!0,filePreviewSrc:this.result})},n.readAsDataURL(t),a.setState({file:t}),ka=t}},a.close=function(){a.setState({file:void 0,popoverOpen:!1}),ka=null},a.state={popoverOpen:!1,content:"",messageInput:"",file:"",filePreviewSrc:""},a.handleSendMessage=a.handleSendMessage.bind(Object(ma.a)(a)),a}return Object(pa.a)(n,[{key:"handleSendMessage",value:function(e){e.preventDefault(),(ka||this.messageInput.value.length>0)&&(this.props.sendMessageLoading(this.messageInput.value),this.messageInput.value="",this.close())}},{key:"render",value:function(){var e=this,t=this.state.filePreviewSrc,n="btn btn-block "+(this.state.file?"btn-success":"btn-primary"),a=this.props.isLoading?"chatApp__convButton--loading":"",o=r.a.createElement(va.a,{color:"action"});return r.a.createElement("form",{onSubmit:this.handleSendMessage},r.a.createElement("div",{className:"chatApp__convButtonLeft"+a},r.a.createElement("input",{accept:"image/*",className:"zeroWidth",id:"icon-button-file",onChange:this.handleFileChange,type:"file"}),r.a.createElement("label",{className:"fileUploadIcon",htmlFor:"icon-button-file"},r.a.createElement(I.a,{color:"primary",className:"fileUploadIcon","aria-label":"upload picture",component:"span"},r.a.createElement(Hn.a,{className:"fileUploadIcon"}))),r.a.createElement("label",{className:n,id:"Popover1"},r.a.createElement("i",{className:"fas fa-camera"})),r.a.createElement(ha.a,{placement:"top-start",isOpen:this.state.popoverOpen,target:"Popover1"},r.a.createElement(Ea.a,null,r.a.createElement("span",null,"Preview"),r.a.createElement("button",{type:"button",className:"close","aria-label":"Close",onClick:this.close},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement(ya.a,null,r.a.createElement("img",{alt:"previw",className:"msg-image",src:t})))),r.a.createElement("input",{type:"hidden",ref:function(t){return e.ownerInput=t},value:this.props.owner}),r.a.createElement("input",{type:"hidden",ref:function(t){return e.ownerAvatarInput=t},value:this.props.ownerAvatar}),r.a.createElement("input",{type:"text",ref:function(t){return e.messageInput=t},className:"chatApp__convInput",placeholder:"Text message"}),r.a.createElement("div",{className:"chatApp__convButton "+a,onClick:this.handleSendMessage},o))}}]),n}(r.a.Component),xa=function(e){Object(ba.a)(n,e);var t=Object(fa.a)(n);function n(e){return Object(da.a)(this,n),t.call(this,e)}return Object(pa.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"chatApp__convTimeline"},this.props.messages.slice(0).reverse().map((function(t){return r.a.createElement(wa,{key:t.id,owner:e.props.owner,sender:t.owner,senderAvatar:t.senderAvatar,message:t.content,file:t.file})})))}}]),n}(r.a.Component),wa=function(e){Object(ba.a)(n,e);var t=Object(fa.a)(n);function n(e){var a;return Object(da.a)(this,n),(a=t.call(this,e)).senderAvatar="https://i.pravatar.cc/150?img=56",a.state={fileUrl:null,key:""},a}return Object(pa.a)(n,[{key:"componentDidUpdate",value:function(e,t){var n=e.file,a=this.props.file,r=null;a&&(r=JSON.parse(a)),n&&null===n.key&&r&&r.key&&this.checkFileUrl()}},{key:"componentDidMount",value:function(){var e=Object(We.a)(De.a.mark((function e(){return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkFileUrl();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkFileUrl",value:function(){var e=Object(We.a)(De.a.mark((function e(){var t,n,a,r;return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.file,console.log("New url for ",t),!t){e.next=16;break}if(n=JSON.parse(t),!(a=Mt.c.getItem(n.key))){e.next=9;break}return console.log("Retrieved cache url for ".concat(n.key,": ").concat(a)),this.setState({key:n.key}),e.abrupt("return",this.setState({fileUrl:a}));case 9:return e.next=11,Object(Qe.getImages)(n);case 11:a=e.sent,console.log("Retrieved cache url for ".concat(n.key,": ").concat(a)),r=new Date((new Date).getTime()+84e4).getTime(),Mt.c.setItem(n.key,a,{expires:r}),this.setState({fileUrl:a});case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.owner==this.props.sender?"highlight msg-right":"highlight",t=this.props.owner==this.props.sender?"chatApp__convMessageItem--right":"chatApp__convMessageItem--left";return r.a.createElement("div",{className:"chatApp__convMessageItem "+t+" clearfix"},r.a.createElement("img",{src:this.senderAvatar,alt:this.props.sender,className:"chatApp__convMessageAvatar"}),this.props.file&&this.state.fileUrl?r.a.createElement("div",{className:e},r.a.createElement("img",{alt:"awesome",src:this.senderAvatar,className:"msg-image",id:"ImgPopover"})):r.a.createElement("div",{className:"chatApp__convMessageValue",dangerouslySetInnerHTML:{__html:this.props.message}}))}}]),n}(r.a.Component),Sa=function(e){Object(ba.a)(n,e);var t=Object(fa.a)(n);function n(e){var a;Object(da.a)(this,n),(a=t.call(this,e)).state={isLoading:!1},a.sendMessageLoading=a.sendMessageLoading.bind(Object(ma.a)(a));return a}return Object(pa.a)(n,[{key:"sendMessageLoading",value:function(e){var t=this;this.setState({isLoading:!0}),this.props.sendMessage(e),setTimeout((function(){t.setState({isLoading:!1})}),400)}},{key:"render",value:function(){return r.a.createElement("div",{className:"chatApp__conv"},r.a.createElement(ja,{owner:this.props.senderUsername,backButton:this.props.backButton}),r.a.createElement(xa,{owner:this.props.owner,messages:this.props.messages}),r.a.createElement("div",{className:"chatApp__convSendMessage clearfix"},r.a.createElement(Ca,{isLoading:this.state.isLoading,owner:this.props.owner,ownerAvatar:this.props.ownerAvatar,sendMessage:this.props.sendMessage,sendMessageLoading:this.sendMessageLoading,senderUsername:this.props.senderUsername})))}}]),n}(r.a.Component),Ia=function(e){Object(ba.a)(n,e);var t=Object(fa.a)(n);function n(e){var a;return Object(da.a)(this,n),(a=t.call(this,e)).sendMessage=function(){var e=Object(We.a)(De.a.mark((function e(t){var n,r,o;return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.trim().length||ka){e.next=2;break}return e.abrupt("return");case 2:if(!ka){e.next=11;break}return e.next=5,Object(Qe.handleImageUpload)([ka]);case 5:r=e.sent,console.log("file for s3",r),o=JSON.stringify(r),n={id:Object(Oa.v4)(),isSent:!0,chatbot:!1,file:o,messageConversationId:a.props.selectedConv.convId},e.next=12;break;case 11:n={id:Object(Oa.v4)(),isSent:!0,chatbot:!1,content:t,messageConversationId:a.props.selectedConv.convId};case 12:return e.prev=12,e.next=15,Mt.a.graphql(Object(Mt.g)($t,{input:n}));case 15:e.sent,e.next=20;break;case 18:e.prev=18,e.t0=e.catch(12);case 20:case"end":return e.stop()}}),e,null,[[12,18]])})));return function(t){return e.apply(this,arguments)}}(),a.state={messages:[{id:1,sender:"Shun",senderAvatar:"https://i.pravatar.cc/150?img=32",message:"Hello \ud83d\udc4b"},{id:2,sender:"Gabe",senderAvatar:"https://i.pravatar.cc/150?img=56",message:"Hey!"},{id:3,sender:"Gabe",senderAvatar:"https://i.pravatar.cc/150?img=56",message:"How are you?"},{id:4,sender:"Shun",senderAvatar:"https://i.pravatar.cc/150?img=32",message:"Great! It's been a while... \ud83d\ude43"},{id:5,sender:"Gabe",senderAvatar:"https://i.pravatar.cc/150?img=56",message:"Indeed.... We're gonna have to fix that. \ud83c\udf2e\ud83c\udf7b"}]},a.sendMessage=a.sendMessage.bind(Object(ma.a)(a)),a}return Object(pa.a)(n,[{key:"componentDidMount",value:function(){var e=Object(We.a)(De.a.mark((function e(){var t,n,a,r=this;return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("props",this.props.selectedConv),t=this.props.selectedConv.convId,e.prev=2,e.next=5,Mt.a.graphql(Object(Mt.g)(rn,{id:t}));case 5:n=e.sent,console.log("messages",n),n.data.getConvo.messages?(a=n.data.getConvo.messages.items,this.setState({messages:a.reverse()})):this.setState({messages:[]}),Mt.a.graphql(Object(Mt.g)(An,{messageConversationId:t})).subscribe({next:function(e){var t=e.value.data.onCreateMessage,n=r.state.messages;n.push(t),r.setState({messages:n})}}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log("error: ",e.t0);case 14:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=[],t=[],n=this.state.messages,a=this.sendMessage;e[0]={name:"de1aa72c-0ab0-472b-9eed-2e88693321ee",avatar:"https://i.pravatar.cc/150?img=32"};var o=this.props.selectedConv,c=this.props.backButton;return Object.keys(e).map((function(i){e[i];t.push(r.a.createElement(Sa,{key:i,owner:o.owner,ownerAvatar:o.ownerAvatar,sendMessage:a,messages:n,backButton:c,senderUsername:o.senderUsername}))})),r.a.createElement("div",{className:"chatApp__room"},t)}}]),n}(r.a.Component),Na=Object(j.a)((function(e){return Object(k.a)({root:{width:"100%",maxWidth:400,backgroundColor:e.palette.background.paper},inline:{display:"inline"},button:{width:20,marginTop:15,padding:5,margin:e.spacing(1)},rating:{marginLeft:15},buttonCart:{marginLeft:5,marginTop:15,width:10},buttonGird:{width:90},cartLabel:{width:10,marginBottom:8,marginLeft:5}})}));function Ua(){var e=Na(),t=r.a.useState([]),n=Object(m.a)(t,2),o=n[0],c=n[1],i=Object(a.useContext)(s.a),l=r.a.useState(!1),p=Object(m.a)(l,2),f=p[0],b=p[1],g=r.a.useState({convId:"",senderUsername:"",owner:"",ownerAvatar:"",senderAvatar:"",sender:""}),v=Object(m.a)(g,2),h=v[0],E=v[1],y=Object(u.h)();Object(a.useEffect)((function(){if(y.state&&y.state.conversation){var e,t,n,a;console.log(y);var r=y.state.conversation.conversation,o=y.state.user,c=r.associated.items.filter((function(e){return e.convoLinkUserId==o||e.convoLinkEmployeeId==o})),i=r.associated.items.filter((function(e){return!(e.convoLinkUserId==o||e.convoLinkEmployeeId==o)}));console.log(c,i),E({convId:r.id,owner:o,ownerAvatar:"https://i.pravatar.cc/150?img=56",senderAvatar:"https://i.pravatar.cc/159?img=2",senderUsername:null!==(e=null===(t=i[0].user)||void 0===t?void 0:t.username)&&void 0!==e?e:null===(n=i[0].employee)||void 0===n?void 0:n.username,sender:null!==(a=i[0].convoLinkEmployeeId)&&void 0!==a?a:i[0].convoLinkUserId}),b(!0)}}),[y]),Object(a.useEffect)((function(){var e=function(){var e=Object(We.a)(De.a.mark((function e(){var t,n,a,r,o,s;return De.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=i.userId,n=i.user.attributes["custom:account_type"],console.log("authContext",i,n),"Customer"!=n){e.next=11;break}return e.next=7,Mt.a.graphql(Object(Mt.g)(cn,{id:t}));case 7:(a=e.sent).data.getUser&&a.data.getUser.userConversations.items.length>0&&((r=a.data.getUser.userConversations.items).forEach((function(e,n,a){var r,o,c,i=e.conversation.associated.items.filter((function(e){return!(e.convoLinkUserId==t||e.convoLinkEmployeeId==t)}));a[n].username=null!==(r=null===(o=i[0].user)||void 0===o?void 0:o.username)&&void 0!==r?r:null===(c=i[0].employee)||void 0===c?void 0:c.username})),c(r)),e.next=16;break;case 11:return e.next=13,Mt.a.graphql(Object(Mt.g)(sn,{id:t}));case 13:o=e.sent,console.log("getEmployeeConversations",o),o.data.getEmployee&&o.data.getEmployee.employeeConversations.items.length>0&&((s=o.data.getEmployee.employeeConversations.items).forEach((function(e,n,a){var r,o,c,i=e.conversation.associated.items.filter((function(e){return!(e.convoLinkUserId==t||e.convoLinkEmployeeId==t)}));a[n].username=null!==(r=null===(o=i[0].user)||void 0===o?void 0:o.username)&&void 0!==r?r:null===(c=i[0].employee)||void 0===c?void 0:c.username})),c(s));case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.log("unable get conversation for users:",e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(){return e.apply(this,arguments)}}();i.userId&&e()}),[i.userId]);return r.a.createElement("div",null,0==f?r.a.createElement(pt,{title:"RA2 Serverless"},r.a.createElement(Cn.a,{className:e.root},o.length>0?o.map((function(e,t){return r.a.createElement("div",{key:e.id},r.a.createElement(xn.a,{key:e.id,alignItems:"flex-start",dense:!0,button:!0,onClick:(n=e,function(){var e,t=i.userId,a=(n.conversation.associated.items.filter((function(e){return e.convoLinkUserId==t||e.convoLinkEmployeeId==t})),n.conversation.associated.items.filter((function(e){return!(e.convoLinkUserId==t||e.convoLinkEmployeeId==t)})));E({convId:n.conversation.id,owner:i.userId,ownerAvatar:"https://i.pravatar.cc/150?img=56",senderAvatar:"https://i.pravatar.cc/159?img=2",senderUsername:n.username,sender:null!==(e=a[0].convoLinkEmployeeId)&&void 0!==e?e:a[0].convoLinkUserId}),b(!0),console.log("value",n)})},r.a.createElement(ua.a,null,r.a.createElement(Ee.a,{alt:"Remy Sharp",src:"https://picsum.photos/200/200"})),r.a.createElement(wn.a,{primary:e.username})),r.a.createElement(nt.a,{variant:"inset",component:"li"}));var n})):r.a.createElement(d.a,{container:!0,direction:"row",justify:"center",alignItems:"center"},r.a.createElement("div",null,"No Message Available ")))):r.a.createElement("div",null,r.a.createElement(Ia,{selectedConv:h,backButton:function(){b(!1)}})))}var Ta=function(){Object(u.g)();var e=r.a.useContext(s.a),t=function(t){var n=t.component,a=Object(l.a)(t,["component"]);return r.a.createElement(u.b,Object.assign({},a,{render:function(t){return e.userId?r.a.createElement(n,t):r.a.createElement(u.a,{to:"/auth"})}}))};return r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/",component:la}),r.a.createElement(u.b,{path:"/auth",component:qe}),r.a.createElement(t,{path:"/chat",component:Ua}),r.a.createElement(t,{path:"/checkout",component:En}),r.a.createElement(t,{path:"/createticket",component:kn}),r.a.createElement(t,{path:"/ticketList",component:la}),"/>")},Aa=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function _a(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Pa=n(105),$a=JSON.parse(JSON.stringify(Pa.a));Mt.f.configure($a);var La=r.a.createElement(i.a,{basename:""},r.a.createElement(s.b,null,r.a.createElement(Ta,null)));c.a.render(La,document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Aa?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):_a(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):_a(t,e)}))}}()},79:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(131),r=n(0),o=n.n(r),c=n(162),i=n(8),s=n(720),l=n(718),u=n(71),m=n.n(u),d=n(66),p=Object(i.a)((function(e){return Object(c.a)({root:{margin:0,padding:e.spacing(2),color:"#fff",backgroundColor:"#3f51b5"},title:{color:"#fff",backgroundColor:"#3f51b5"},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}})}))((function(e){var t=e.children,n=e.classes,r=e.onClose,c=Object(a.a)(e,["children","classes","onClose"]);return o.a.createElement(s.a,Object.assign({disableTypography:!0,className:n.root},c),o.a.createElement(d.a,{className:n.title,variant:"h6"},t),r?o.a.createElement(l.a,{"aria-label":"close",className:n.closeButton,onClick:r},o.a.createElement(m.a,null)):null)}))}},[[277,1,2]]]);
//# sourceMappingURL=main.219e2d5d.chunk.js.map